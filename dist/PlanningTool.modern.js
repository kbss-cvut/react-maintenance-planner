import e,{Component as t}from"react";import i from"moment";import s from"interactjs";import r from"lodash.isequal";import{jsxs as n,jsx as o}from"react/jsx-runtime";import a from"classnames";import l from"react-xarrows";function h(){return h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},h.apply(this,arguments)}function d(e){var t={exports:{}};return e(t,t.exports),t.exports}var c="function"==typeof Symbol&&Symbol.for,p=c?Symbol.for("react.element"):60103,u=c?Symbol.for("react.portal"):60106,m=c?Symbol.for("react.fragment"):60107,g=c?Symbol.for("react.strict_mode"):60108,f=c?Symbol.for("react.profiler"):60114,v=c?Symbol.for("react.provider"):60109,b=c?Symbol.for("react.context"):60110,y=c?Symbol.for("react.async_mode"):60111,T=c?Symbol.for("react.concurrent_mode"):60111,S=c?Symbol.for("react.forward_ref"):60112,R=c?Symbol.for("react.suspense"):60113,C=c?Symbol.for("react.suspense_list"):60120,z=c?Symbol.for("react.memo"):60115,M=c?Symbol.for("react.lazy"):60116,I=c?Symbol.for("react.block"):60121,k=c?Symbol.for("react.fundamental"):60117,D=c?Symbol.for("react.responder"):60118,w=c?Symbol.for("react.scope"):60119;function x(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case p:switch(e=e.type){case y:case T:case m:case f:case g:case R:return e;default:switch(e=e&&e.$$typeof){case b:case S:case M:case z:case v:return e;default:return t}}case u:return t}}}function E(e){return x(e)===T}var L={AsyncMode:y,ConcurrentMode:T,ContextConsumer:b,ContextProvider:v,Element:p,ForwardRef:S,Fragment:m,Lazy:M,Memo:z,Portal:u,Profiler:f,StrictMode:g,Suspense:R,isAsyncMode:function(e){return E(e)||x(e)===y},isConcurrentMode:E,isContextConsumer:function(e){return x(e)===b},isContextProvider:function(e){return x(e)===v},isElement:function(e){return"object"==typeof e&&null!==e&&e.$$typeof===p},isForwardRef:function(e){return x(e)===S},isFragment:function(e){return x(e)===m},isLazy:function(e){return x(e)===M},isMemo:function(e){return x(e)===z},isPortal:function(e){return x(e)===u},isProfiler:function(e){return x(e)===f},isStrictMode:function(e){return x(e)===g},isSuspense:function(e){return x(e)===R},isValidElementType:function(e){return"string"==typeof e||"function"==typeof e||e===m||e===T||e===f||e===g||e===R||e===C||"object"==typeof e&&null!==e&&(e.$$typeof===M||e.$$typeof===z||e.$$typeof===v||e.$$typeof===b||e.$$typeof===S||e.$$typeof===k||e.$$typeof===D||e.$$typeof===w||e.$$typeof===I)},typeOf:x},O=d(function(e,t){"production"!==process.env.NODE_ENV&&function(){var e="function"==typeof Symbol&&Symbol.for,i=e?Symbol.for("react.element"):60103,s=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,n=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,a=e?Symbol.for("react.provider"):60109,l=e?Symbol.for("react.context"):60110,h=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,c=e?Symbol.for("react.forward_ref"):60112,p=e?Symbol.for("react.suspense"):60113,u=e?Symbol.for("react.suspense_list"):60120,m=e?Symbol.for("react.memo"):60115,g=e?Symbol.for("react.lazy"):60116,f=e?Symbol.for("react.block"):60121,v=e?Symbol.for("react.fundamental"):60117,b=e?Symbol.for("react.responder"):60118,y=e?Symbol.for("react.scope"):60119;function T(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:var u=e.type;switch(u){case h:case d:case r:case o:case n:case p:return u;default:var f=u&&u.$$typeof;switch(f){case l:case c:case g:case m:case a:return f;default:return t}}case s:return t}}}var S=d,R=l,C=a,z=i,M=c,I=r,k=g,D=m,w=s,x=o,E=n,L=p,O=!1;function P(e){return T(e)===d}t.AsyncMode=h,t.ConcurrentMode=S,t.ContextConsumer=R,t.ContextProvider=C,t.Element=z,t.ForwardRef=M,t.Fragment=I,t.Lazy=k,t.Memo=D,t.Portal=w,t.Profiler=x,t.StrictMode=E,t.Suspense=L,t.isAsyncMode=function(e){return O||(O=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),P(e)||T(e)===h},t.isConcurrentMode=P,t.isContextConsumer=function(e){return T(e)===l},t.isContextProvider=function(e){return T(e)===a},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===i},t.isForwardRef=function(e){return T(e)===c},t.isFragment=function(e){return T(e)===r},t.isLazy=function(e){return T(e)===g},t.isMemo=function(e){return T(e)===m},t.isPortal=function(e){return T(e)===s},t.isProfiler=function(e){return T(e)===o},t.isStrictMode=function(e){return T(e)===n},t.isSuspense=function(e){return T(e)===p},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===r||e===d||e===o||e===n||e===p||e===u||"object"==typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===a||e.$$typeof===l||e.$$typeof===c||e.$$typeof===v||e.$$typeof===b||e.$$typeof===y||e.$$typeof===f)},t.typeOf=T}()}),P=d(function(e){e.exports="production"===process.env.NODE_ENV?L:O}),W=Object.getOwnPropertySymbols,H=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;function N(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var F=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;var s=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==s.join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var i,s,r=N(e),n=1;n<arguments.length;n++){for(var o in i=Object(arguments[n]))H.call(i,o)&&(r[o]=i[o]);if(W){s=W(i);for(var a=0;a<s.length;a++)q.call(i,s[a])&&(r[s[a]]=i[s[a]])}}return r},j=Function.call.bind(Object.prototype.hasOwnProperty),$="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",K=j,U=function(){};if("production"!==process.env.NODE_ENV){var G=$,Y={},A=K;U=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}}}function _(e,t,i,s,r){if("production"!==process.env.NODE_ENV)for(var n in e)if(A(e,n)){var o;try{if("function"!=typeof e[n]){var a=Error((s||"React class")+": "+i+" type `"+n+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[n]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw a.name="Invariant Violation",a}o=e[n](t,n,s,i,null,G)}catch(e){o=e}if(!o||o instanceof Error||U((s||"React class")+": type specification of "+i+" `"+n+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof o+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),o instanceof Error&&!(o.message in Y)){Y[o.message]=!0;var l=r?r():"";U("Failed "+i+" type: "+o.message+(null!=l?l:""))}}}_.resetWarningCache=function(){"production"!==process.env.NODE_ENV&&(Y={})};var B=_,V=function(){};function X(){return null}function Z(){}function J(){}"production"!==process.env.NODE_ENV&&(V=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}}),J.resetWarningCache=Z;var Q=d(function(e){e.exports="production"!==process.env.NODE_ENV?function(e,t){var i="function"==typeof Symbol&&Symbol.iterator,s="<<anonymous>>",r={array:l("array"),bigint:l("bigint"),bool:l("boolean"),func:l("function"),number:l("number"),object:l("object"),string:l("string"),symbol:l("symbol"),any:a(X),arrayOf:function(e){return a(function(t,i,s,r,n){if("function"!=typeof e)return new o("Property `"+n+"` of component `"+s+"` has invalid PropType notation inside arrayOf.");var a=t[i];if(!Array.isArray(a))return new o("Invalid "+r+" `"+n+"` of type `"+c(a)+"` supplied to `"+s+"`, expected an array.");for(var l=0;l<a.length;l++){var h=e(a,l,s,r,n+"["+l+"]",$);if(h instanceof Error)return h}return null})},element:a(function(t,i,s,r,n){var a=t[i];return e(a)?null:new o("Invalid "+r+" `"+n+"` of type `"+c(a)+"` supplied to `"+s+"`, expected a single ReactElement.")}),elementType:a(function(e,t,i,s,r){var n=e[t];return P.isValidElementType(n)?null:new o("Invalid "+s+" `"+r+"` of type `"+c(n)+"` supplied to `"+i+"`, expected a single ReactElement type.")}),instanceOf:function(e){return a(function(t,i,r,n,a){return t[i]instanceof e?null:new o("Invalid "+n+" `"+a+"` of type `"+((l=t[i]).constructor&&l.constructor.name?l.constructor.name:s)+"` supplied to `"+r+"`, expected instance of `"+(e.name||s)+"`.");var l})},node:a(function(e,t,i,s,r){return d(e[t])?null:new o("Invalid "+s+" `"+r+"` supplied to `"+i+"`, expected a ReactNode.")}),objectOf:function(e){return a(function(t,i,s,r,n){if("function"!=typeof e)return new o("Property `"+n+"` of component `"+s+"` has invalid PropType notation inside objectOf.");var a=t[i],l=c(a);if("object"!==l)return new o("Invalid "+r+" `"+n+"` of type `"+l+"` supplied to `"+s+"`, expected an object.");for(var h in a)if(K(a,h)){var d=e(a,h,s,r,n+"."+h,$);if(d instanceof Error)return d}return null})},oneOf:function(e){if(!Array.isArray(e))return"production"!==process.env.NODE_ENV&&V(arguments.length>1?"Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).":"Invalid argument supplied to oneOf, expected an array."),X;function t(t,i,s,r,a){for(var l=t[i],h=0;h<e.length;h++)if(n(l,e[h]))return null;var d=JSON.stringify(e,function(e,t){return"symbol"===p(t)?String(t):t});return new o("Invalid "+r+" `"+a+"` of value `"+String(l)+"` supplied to `"+s+"`, expected one of "+d+".")}return a(t)},oneOfType:function(e){if(!Array.isArray(e))return"production"!==process.env.NODE_ENV&&V("Invalid argument supplied to oneOfType, expected an instance of array."),X;for(var t=0;t<e.length;t++){var i=e[t];if("function"!=typeof i)return V("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+u(i)+" at index "+t+"."),X}return a(function(t,i,s,r,n){for(var a=[],l=0;l<e.length;l++){var h=(0,e[l])(t,i,s,r,n,$);if(null==h)return null;h.data&&K(h.data,"expectedType")&&a.push(h.data.expectedType)}return new o("Invalid "+r+" `"+n+"` supplied to `"+s+"`"+(a.length>0?", expected one of type ["+a.join(", ")+"]":"")+".")})},shape:function(e){return a(function(t,i,s,r,n){var a=t[i],l=c(a);if("object"!==l)return new o("Invalid "+r+" `"+n+"` of type `"+l+"` supplied to `"+s+"`, expected `object`.");for(var d in e){var u=e[d];if("function"!=typeof u)return h(s,r,n,d,p(u));var m=u(a,d,s,r,n+"."+d,$);if(m)return m}return null})},exact:function(e){return a(function(t,i,s,r,n){var a=t[i],l=c(a);if("object"!==l)return new o("Invalid "+r+" `"+n+"` of type `"+l+"` supplied to `"+s+"`, expected `object`.");var d=F({},t[i],e);for(var u in d){var m=e[u];if(K(e,u)&&"function"!=typeof m)return h(s,r,n,u,p(m));if(!m)return new o("Invalid "+r+" `"+n+"` key `"+u+"` supplied to `"+s+"`.\nBad object: "+JSON.stringify(t[i],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var g=m(a,u,s,r,n+"."+u,$);if(g)return g}return null})}};function n(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function o(e,t){this.message=e,this.data=t&&"object"==typeof t?t:{},this.stack=""}function a(e){function t(t,i,r,n,a,l,h){if(n=n||s,l=l||r,h!==$){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}return null==i[r]?t?new o(null===i[r]?"The "+a+" `"+l+"` is marked as required in `"+n+"`, but its value is `null`.":"The "+a+" `"+l+"` is marked as required in `"+n+"`, but its value is `undefined`."):null:e(i,r,n,a,l)}process;var i=t.bind(null,!1);return i.isRequired=t.bind(null,!0),i}function l(e){return a(function(t,i,s,r,n,a){var l=t[i];return c(l)!==e?new o("Invalid "+r+" `"+n+"` of type `"+p(l)+"` supplied to `"+s+"`, expected `"+e+"`.",{expectedType:e}):null})}function h(e,t,i,s,r){return new o((e||"React class")+": "+t+" type `"+i+"."+s+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+r+"`.")}function d(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(d);if(null===t||e(t))return!0;var s=function(e){var t=e&&(i&&e[i]||e["@@iterator"]);if("function"==typeof t)return t}(t);if(!s)return!1;var r,n=s.call(t);if(s!==t.entries){for(;!(r=n.next()).done;)if(!d(r.value))return!1}else for(;!(r=n.next()).done;){var o=r.value;if(o&&!d(o[1]))return!1}return!0;default:return!1}}function c(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||!!t&&("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}(t,e)?"symbol":t}function p(e){if(null==e)return""+e;var t=c(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function u(e){var t=p(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return o.prototype=Error.prototype,r.checkPropTypes=B,r.resetWarningCache=B.resetWarningCache,r.PropTypes=r,r}(P.isElement):function(){function e(e,t,i,s,r,n){if(n!==$){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var i={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:J,resetWarningCache:Z};return i.PropTypes=i,i}()});function ee(e,t){return"function"==typeof e.get?e.get(t):e[t]}function te(e){return"function"==typeof e.count?e.count():e.length}function ie(e,t){return te(e)===te(t)&&e.every((e,i)=>e===ee(t,i))}function se(){}function re(...e){return(t,...i)=>{t.preventDefault(),e.forEach(e=>e&&e(t,...i))}}const ne=({item:e,itemContext:t,getItemProps:i,getResizeProps:s})=>{const{left:r,right:a}=s();/*#__PURE__*/return n("div",h({},i(e.itemProps),{children:[t.useResizeHandle?/*#__PURE__*/o("div",h({},r)):"",/*#__PURE__*/o("div",{className:"rct-item-content",style:{maxHeight:`${t.dimensions.height}`},children:t.title}),t.useResizeHandle?/*#__PURE__*/o("div",h({},a)):""]}))};function oe(e,t,i){return(t-e)/i}function ae(e,t,i,s){return i/(t-e)*(s-e)}function le(e,t,i,s){return(t-e)/i*s+e}function he(e,t,s,r,n){let o=i(e).startOf(s);if(r[s]&&r[s]>1){let e=o.get(s);o.set(s,e-e%r[s])}for(;o.valueOf()<t;){let e=i(o).add(r[s]||1,`${s}s`);n(o,e),o=e}}function de(e,t,i){let s={second:1e3,minute:60,hour:60,day:24,month:30,year:12},r="year",n=e;return Object.keys(s).some(e=>{if(n/=s[e],n/i[e]<t/(i[e]&&i[e]>1?51:17))return r=e,!0}),r}function ce(e){let t={second:"minute",minute:"hour",hour:"day",day:"month",month:"year",year:"year"};if(!t[e])throw new Error(`unit ${e} in not acceptable`);return t[e]}function pe(e,t){const{groupIdKey:i}=t;let s={};for(let t=0;t<e.length;t++)s[ee(e[t],i)]={index:t,group:e[t]};return s}function ue(e,t,i,s){const{itemTimeStartKey:r,itemTimeEndKey:n}=s;return e.filter(e=>ee(e,r)<=i&&ee(e,n)>=t)}function me(e,t,i,s=.001){return e.collisionLeft+s<t.collisionLeft+t.collisionWidth&&e.collisionLeft+e.collisionWidth-s>t.collisionLeft&&e.top-0+s<t.top+t.height&&e.top+e.height+0-s>t.top}function ge(e,t,i,s,r,n){let o=s,a=(e-t.dimensions.height)/2;if(t.dimensions.stack&&null===t.dimensions.top){t.dimensions.top=r+a,o=Math.max(o,e);do{for(var l=null,h=n-1;h>=0;h--){var d=i[h];if(null!==d.dimensions.top&&d.dimensions.stack&&me(t.dimensions,d.dimensions)){l=d;break}}null!=l&&(t.dimensions.top=l.dimensions.top+e,o=Math.max(o,t.dimensions.top+t.dimensions.height+a-r))}while(l)}return{groupHeight:o,verticalMargin:a,itemTop:t.dimensions.top}}function fe(e,t,i,s){return null===t.dimensions.top&&(t.dimensions.top=s+(e-t.dimensions.height)/2,i=Math.max(i,e)),{groupHeight:i,verticalMargin:0,itemTop:t.dimensions.top}}function ve(e=[]){return e.reduce((e,t)=>e+t,0)}function be(e,t,i,s){var r=0,n=0;for(let o=0;o<e.length;o++){let a={};a=t?ge(i,e[o],e,r,s,o):fe(i,e[o],r,s),r=a.groupHeight,n=a.verticalMargin}return{groupHeight:r,verticalMargin:n}}function ye(e,t,i,s,r,n,o,a,l,d,c,p,u,m,g){const f=ue(e,s,r,n).map(e=>function({item:e,keys:t,draggingItem:i,resizingItem:s,dragTime:r,resizingEdge:n,resizeTime:o,groups:a,newGroupOrder:l}){if(!s&&!i)return e;const d=ee(e,t.itemIdKey),c=d===i,p=d===s,[u,m]=function({itemTimeStart:e,itemTimeEnd:t,dragTime:i,isDragging:s,isResizing:r,resizingEdge:n,resizeTime:o}){return[s?i:r&&"left"===n?o:e,s?i+(t-e):r&&"right"===n?o:t]}({itemTimeStart:ee(e,t.itemTimeStartKey),itemTimeEnd:ee(e,t.itemTimeEndKey),isDragging:c,isResizing:p,dragTime:r,resizingEdge:n,resizeTime:o});return h({},e,{[t.itemTimeStartKey]:u,[t.itemTimeEndKey]:m,[t.itemGroupKey]:c?ee(a[l],t.groupIdKey):ee(e,t.itemGroupKey)})}({item:e,keys:n,draggingItem:d,resizingItem:c,dragTime:p,resizingEdge:u,resizeTime:m,groups:t,newGroupOrder:g}));if(0===t.length)return{dimensionItems:[],height:0,groupHeights:[],groupTops:[]};const v=pe(t,n);let b=f.map(e=>function({item:e,keys:t,canvasTimeStart:i,canvasTimeEnd:s,canvasWidth:r,groupOrders:n,lineHeight:o,itemHeightRatio:a}){const l=ee(e,t.itemIdKey);let h=function({itemTimeStart:e,itemTimeEnd:t,canvasTimeStart:i,canvasTimeEnd:s,canvasWidth:r}){const n=t-e,o=Math.max(e,i),a=Math.min(t,s),l=ae(i,s,r,o),h=ae(i,s,r,a);return{left:l,width:Math.max(h-l,3),collisionLeft:e,collisionWidth:n}}({itemTimeStart:ee(e,t.itemTimeStartKey),itemTimeEnd:ee(e,t.itemTimeEndKey),canvasTimeStart:i,canvasTimeEnd:s,canvasWidth:r});if(h)return h.top=null,h.order=n[ee(e,t.itemGroupKey)],h.stack=!e.isOverlay,h.height=o*a,{id:l,dimensions:h}}({item:e,keys:n,canvasTimeStart:s,canvasTimeEnd:r,canvasWidth:i,groupOrders:v,lineHeight:o,itemHeightRatio:a})).filter(e=>!!e);const{height:y,groupHeights:T,groupTops:S}=function(e,t,i,s){var r=[],n=[],o=function(e,t){var i={},s=Object.keys(t);for(let e=0;e<s.length;e++){const r=t[s[e]];i[e]={index:r.index,group:r.group,items:[]}}for(let t=0;t<e.length;t++)if(void 0!==e[t].dimensions.order){const s=i[e[t].dimensions.order.index];s&&s.items.push(e[t])}return i}(e,t);for(var a in o){const e=o[a],{items:t,group:l}=e,h=ve(r),d=void 0!==l.stackItems?l.stackItems:s,{groupHeight:c}=be(t,d,i,h);n.push(h),r.push(l.height?l.height:Math.max(c,i))}return{height:ve(r),groupHeights:r,groupTops:n}}(b,v,o,l);return{dimensionItems:b,height:y,groupHeights:T,groupTops:S}}function Te(e,t=3){return e*t}function Se(e,t){const i=e-(t-e);return[i,i+3*(t-e)]}function Re(e,t,i,s,r,n,o){const a=o.canvasTimeStart,l=o.visibleTimeEnd-o.visibleTimeStart,d={visibleTimeStart:e,visibleTimeEnd:t};if(!(t-e===l&&e>=a+.5*l&&e<=a+1.5*l&&t>=a+1.5*l&&t<=a+2.5*l)||i){const[i,a]=Se(e,t);d.canvasTimeStart=i,d.canvasTimeEnd=a;const l=h({},o,d),c=Te(l.width);Object.assign(d,ye(s,r,c,l.canvasTimeStart,l.canvasTimeEnd,n.keys,n.lineHeight,n.itemHeightRatio,n.stackItems,l.draggingItem,l.resizingItem,l.dragTime,l.resizingEdge,l.resizeTime,l.newGroupOrder))}return d}function Ce(e){for(var t=0,i=0,s=!0;e;)e.offsetParent||"BODY"!==e.tagName||0!==e.scrollLeft||0!==e.scrollTop||(e=document.scrollingElement||e),t+=e.offsetLeft-(s?0:e.scrollLeft)+e.clientLeft,i+=e.offsetTop-(s?0:e.scrollTop)+e.clientTop,e=e.offsetParent,s=!1;return{x:t,y:i}}function ze(e){if(e===document.body)return{scrollLeft:0,scrollTop:0};{const t=ze(e.parentNode);return{scrollLeft:e.scrollLeft+t.scrollLeft,scrollTop:e.scrollTop+t.scrollTop}}}function Me(e){if(e!==document.body&&e.offsetParent){const t=Me(e.offsetParent);return{offsetLeft:e.offsetLeft+t.offsetLeft,offsetTop:e.offsetTop+t.offsetTop}}return{offsetLeft:0,offsetTop:0}}ne.propTypes={item:Q.any,itemContext:Q.any,getItemProps:Q.any,getResizeProps:Q.any};const Ie={fontSize:12,color:"white",cursor:"pointer",background:"#2196f3",border:"1px solid #1a6fb3",zIndex:80},ke={background:"#ffc107",border:"1px solid #ff9800",zIndex:82},De={cursor:"move"},we={borderLeftWidth:3},xe={cursor:"ew-resize"},Ee={borderRightWidth:3},Le={cursor:"ew-resize"},Oe={position:"absolute",width:24,maxWidth:"20%",minWidth:2,height:"100%",top:0,left:0,cursor:"pointer",zIndex:88},Pe={position:"absolute",width:24,maxWidth:"20%",minWidth:2,height:"100%",top:0,right:0,cursor:"pointer",zIndex:88};class We extends t{constructor(e){super(e),this.onMouseDown=e=>{this.state.interactMounted||(e.preventDefault(),this.startedClicking=!0)},this.onMouseUp=e=>{!this.state.interactMounted&&this.startedClicking&&(this.startedClicking=!1,this.actualClick(e,"click"))},this.onTouchStart=e=>{this.state.interactMounted||(e.preventDefault(),this.startedTouching=!0)},this.onTouchEnd=e=>{!this.state.interactMounted&&this.startedTouching&&(this.startedTouching=!1,this.actualClick(e,"touch"))},this.handleDoubleClick=e=>{e.stopPropagation(),this.props.onItemDoubleClick&&this.props.onItemDoubleClick(this.itemId,e)},this.handleContextMenu=e=>{this.props.onContextMenu&&(e.preventDefault(),e.stopPropagation(),this.props.onContextMenu(this.itemId,e))},this.getItemRef=e=>this.item=e,this.getDragLeftRef=e=>this.dragLeft=e,this.getDragRightRef=e=>this.dragRight=e,this.getItemProps=(e={})=>({key:this.itemId,ref:this.getItemRef,title:this.itemDivTitle,className:"rct-item"+(this.props.item.className?` ${this.props.item.className}`:"")+` ${e.className?e.className:""}`,onMouseDown:re(this.onMouseDown,e.onMouseDown),onMouseUp:re(this.onMouseUp,e.onMouseUp),onTouchStart:re(this.onTouchStart,e.onTouchStart),onTouchEnd:re(this.onTouchEnd,e.onTouchEnd),onDoubleClick:re(this.handleDoubleClick,e.onDoubleClick),onContextMenu:re(this.handleContextMenu,e.onContextMenu),style:Object.assign({},this.getItemStyle(e))}),this.getResizeProps=(e={})=>{let t="rct-item-handler rct-item-handler-left rct-item-handler-resize-left";e.leftClassName&&(t+=` ${e.leftClassName}`);let i="rct-item-handler rct-item-handler-right rct-item-handler-resize-right";return e.rightClassName&&(i+=` ${e.rightClassName}`),{left:{ref:this.getDragLeftRef,className:t,style:Object.assign({},Oe,e.leftStyle)},right:{ref:this.getDragRightRef,className:i,style:Object.assign({},Pe,e.rightStyle)}}},this.cacheDataFromProps(e),this.state={interactMounted:!1,dragging:null,dragStart:null,preDragPosition:null,dragTime:null,dragGroupDelta:null,resizing:null,resizeEdge:null,resizeStart:null,resizeTime:null}}shouldComponentUpdate(e,t){return t.dragging!==this.state.dragging||t.dragTime!==this.state.dragTime||t.dragGroupDelta!==this.state.dragGroupDelta||t.resizing!==this.state.resizing||t.resizeTime!==this.state.resizeTime||e.keys!==this.props.keys||!r(e.itemProps,this.props.itemProps)||e.selected!==this.props.selected||e.item!==this.props.item||e.canvasTimeStart!==this.props.canvasTimeStart||e.canvasTimeEnd!==this.props.canvasTimeEnd||e.canvasWidth!==this.props.canvasWidth||(e.order?e.order.index:void 0)!==(this.props.order?this.props.order.index:void 0)||e.dragSnap!==this.props.dragSnap||e.minResizeWidth!==this.props.minResizeWidth||e.canChangeGroup!==this.props.canChangeGroup||e.canSelect!==this.props.canSelect||e.canMove!==this.props.canMove||e.canResizeLeft!==this.props.canResizeLeft||e.canResizeRight!==this.props.canResizeRight||e.dimensions!==this.props.dimensions}cacheDataFromProps(e){this.itemId=ee(e.item,e.keys.itemIdKey),this.itemTitle=ee(e.item,e.keys.itemTitleKey),this.itemDivTitle=e.keys.itemDivTitleKey?ee(e.item,e.keys.itemDivTitleKey):this.itemTitle,this.itemTimeStart=ee(e.item,e.keys.itemTimeStartKey),this.itemTimeEnd=ee(e.item,e.keys.itemTimeEndKey)}getTimeRatio(){const{canvasTimeStart:e,canvasTimeEnd:t,canvasWidth:i}=this.props;return oe(e,t,i)}dragTimeSnap(e,t){const{dragSnap:s}=this.props;if(s){const r=t?60*i().utcOffset()*1e3:0;return Math.round(e/s)*s-r%s}return e}resizeTimeSnap(e){const{dragSnap:t}=this.props;if(t){const i=this.itemTimeEnd%t;return Math.round((e-i)/t)*t+i}return e}dragTime(e){const t=i(this.itemTimeStart);return this.state.dragging?this.dragTimeSnap(this.timeFor(e)+this.state.dragStart.offset,!0):t}timeFor(e){const t=oe(this.props.canvasTimeStart,this.props.canvasTimeEnd,this.props.canvasWidth),i=Me(this.props.scrollRef).offsetLeft,s=ze(this.props.scrollRef);return(e.pageX-i+s.scrollLeft)*t+this.props.canvasTimeStart}dragGroupDelta(e){const{groupTops:t,order:i}=this.props;if(this.state.dragging){if(!this.props.canChangeGroup)return 0;let r=0;const n=Me(this.props.scrollRef).offsetTop,o=ze(this.props.scrollRef);for(var s of Object.keys(t)){if(!(e.pageY-n+o.scrollTop>t[s]))break;r=parseInt(s,10)-i.index}return this.props.order.index+r<0?0-this.props.order.index:r}return 0}resizeTimeDelta(e,t){const i=this.itemTimeEnd-this.itemTimeStart,s=this.dragTimeSnap((e.pageX-this.state.resizeStart)*this.getTimeRatio());return i+("left"===t?-s:s)<(this.props.dragSnap||1e3)?"left"===t?i-(this.props.dragSnap||1e3):(this.props.dragSnap||1e3)-i:s}mountInteract(){const e=!this.props.useResizeHandle||".rct-item-handler-resize-left",t=!this.props.useResizeHandle||".rct-item-handler-resize-right";s(this.item).resizable({edges:{left:this.canResizeLeft()&&e,right:this.canResizeRight()&&t,top:!1,bottom:!1},enabled:this.props.selected&&(this.canResizeLeft()||this.canResizeRight())}).draggable({enabled:this.props.selected&&this.canMove()}).styleCursor(!1).on("dragstart",e=>{if(!this.props.selected)return!1;{const t=this.timeFor(e);this.setState({dragging:!0,dragStart:{x:e.pageX,y:e.pageY,offset:this.itemTimeStart-t},preDragPosition:{x:e.target.offsetLeft,y:e.target.offsetTop},dragTime:this.itemTimeStart,dragGroupDelta:0})}}).on("dragmove",e=>{if(this.state.dragging){let t=this.dragTime(e),i=this.dragGroupDelta(e);this.props.moveResizeValidator&&(t=this.props.moveResizeValidator("move",this.props.item,t)),this.props.onDrag&&this.props.onDrag(this.itemId,t,this.props.order.index+i),this.setState({dragTime:t,dragGroupDelta:i})}}).on("dragend",e=>{if(this.state.dragging){if(this.props.onDrop){let t=this.dragTime(e);this.props.moveResizeValidator&&(t=this.props.moveResizeValidator("move",this.props.item,t)),this.props.onDrop(this.itemId,t,this.props.order.index+this.dragGroupDelta(e))}this.setState({dragging:!1,dragStart:null,preDragPosition:null,dragTime:null,dragGroupDelta:null})}}).on("resizestart",e=>{if(!this.props.selected)return!1;this.setState({resizing:!0,resizeEdge:null,resizeStart:e.pageX,resizeTime:0})}).on("resizemove",e=>{if(this.state.resizing){let t=this.state.resizeEdge;t||(t=0!==e.deltaRect.left?"left":"right",this.setState({resizeEdge:t}));let i=this.resizeTimeSnap(this.timeFor(e));this.props.moveResizeValidator&&(i=this.props.moveResizeValidator("resize",this.props.item,i,t)),this.props.onResizing&&this.props.onResizing(this.itemId,i,t),this.setState({resizeTime:i})}}).on("resizeend",e=>{if(this.state.resizing){const{resizeEdge:t}=this.state;let i=this.resizeTimeSnap(this.timeFor(e));this.props.moveResizeValidator&&(i=this.props.moveResizeValidator("resize",this.props.item,i,t)),this.props.onResized&&this.props.onResized(this.itemId,i,t,this.resizeTimeDelta(e,t)),this.setState({resizing:null,resizeStart:null,resizeEdge:null,resizeTime:null})}}).on("tap",e=>{this.actualClick(e,"mouse"===e.pointerType?"click":"touch")}),this.setState({interactMounted:!0})}canResizeLeft(e=this.props){return!!e.canResizeLeft&&parseInt(e.dimensions.width,10)>=e.minResizeWidth}canResizeRight(e=this.props){return!!e.canResizeRight&&parseInt(e.dimensions.width,10)>=e.minResizeWidth}canMove(e=this.props){return!!e.canMove}componentDidUpdate(e){this.cacheDataFromProps(this.props);let{interactMounted:t}=this.state;const i=e.selected&&this.canMove(e),r=e.selected&&this.canResizeLeft(e),n=e.selected&&this.canResizeRight(e),o=this.props.selected&&this.canMove(this.props),a=this.props.selected&&this.canResizeLeft(this.props),l=this.props.selected&&this.canResizeRight(this.props);if(this.item){if(this.props.selected&&!t&&(this.mountInteract(),t=!0),t&&(r!==a||n!==l)){const e=!this.props.useResizeHandle||this.dragLeft,t=!this.props.useResizeHandle||this.dragRight;s(this.item).resizable({enabled:a||l,edges:{top:!1,bottom:!1,left:a&&e,right:l&&t}})}t&&i!==o&&s(this.item).draggable({enabled:o})}else t=!1;this.setState({interactMounted:t})}actualClick(e,t){this.props.canSelect&&this.props.onSelect&&this.props.onSelect(this.itemId,t,e)}getItemStyle(e){const t=this.props.dimensions,i={position:"absolute",boxSizing:"border-box",left:`${t.left}px`,top:`${t.top}px`,width:`${t.width}px`,height:`${t.height}px`,lineHeight:`${t.height}px`};return Object.assign({},Ie,this.props.selected?ke:{},this.props.selected&this.canMove(this.props)?De:{},this.props.selected&this.canResizeLeft(this.props)?we:{},this.props.selected&this.canResizeLeft(this.props)&this.state.dragging?xe:{},this.props.selected&this.canResizeRight(this.props)?Ee:{},this.props.selected&this.canResizeRight(this.props)&this.state.dragging?Le:{},e.style,i)}render(){if(null==this.props.order)return null;const e=this.context.getTimelineContext(),t={dimensions:this.props.dimensions,useResizeHandle:this.props.useResizeHandle,title:this.itemTitle,canMove:this.canMove(this.props),canResizeLeft:this.canResizeLeft(this.props),canResizeRight:this.canResizeRight(this.props),selected:this.props.selected,dragging:this.state.dragging,dragStart:this.state.dragStart,dragTime:this.state.dragTime,dragGroupDelta:this.state.dragGroupDelta,resizing:this.state.resizing,resizeEdge:this.state.resizeEdge,resizeStart:this.state.resizeStart,resizeTime:this.state.resizeTime,width:this.props.dimensions.width};return this.props.itemRenderer({item:this.props.item,timelineContext:e,itemContext:t,getItemProps:this.getItemProps,getResizeProps:this.getResizeProps})}}We.propTypes={canvasTimeStart:Q.number.isRequired,canvasTimeEnd:Q.number.isRequired,canvasWidth:Q.number.isRequired,order:Q.object,dragSnap:Q.number,minResizeWidth:Q.number,selected:Q.bool,canChangeGroup:Q.bool.isRequired,canMove:Q.bool.isRequired,canResizeLeft:Q.bool.isRequired,canResizeRight:Q.bool.isRequired,keys:Q.object.isRequired,item:Q.object.isRequired,onSelect:Q.func,onDrag:Q.func,onDrop:Q.func,onResizing:Q.func,onResized:Q.func,onContextMenu:Q.func,itemRenderer:Q.func,itemProps:Q.object,canSelect:Q.bool,dimensions:Q.object,groupTops:Q.array,useResizeHandle:Q.bool,moveResizeValidator:Q.func,onItemDoubleClick:Q.func,scrollRef:Q.object},We.defaultProps={selected:!1,itemRenderer:ne},We.contextTypes={getTimelineContext:Q.func};const He=(e,t)=>{const i=void 0!==ee(e,"canResize")?ee(e,"canResize"):t;return"left"===i||"both"===i},qe=(e,t)=>{const i=void 0!==ee(e,"canResize")?ee(e,"canResize"):t;return"right"===i||"both"===i||!0===i};class Ne extends t{shouldComponentUpdate(e){return!(ie(e.groups,this.props.groups)&&ie(e.items,this.props.items)&&ie(e.dimensionItems,this.props.dimensionItems)&&e.keys===this.props.keys&&e.canvasTimeStart===this.props.canvasTimeStart&&e.canvasTimeEnd===this.props.canvasTimeEnd&&e.canvasWidth===this.props.canvasWidth&&e.selectedItem===this.props.selectedItem&&e.selected===this.props.selected&&e.dragSnap===this.props.dragSnap&&e.minResizeWidth===this.props.minResizeWidth&&e.canChangeGroup===this.props.canChangeGroup&&e.canMove===this.props.canMove&&e.canResize===this.props.canResize&&e.canSelect===this.props.canSelect)}isSelected(e,t){if(this.props.selected){let i=ee(e,t);return this.props.selected.includes(i)}return this.props.selectedItem===ee(e,t)}getVisibleItems(e,t){const{keys:i,items:s}=this.props;return ue(s,e,t,i)}render(){const{canvasTimeStart:e,canvasTimeEnd:t,dimensionItems:i,keys:s,groups:r}=this.props,{itemIdKey:n,itemGroupKey:a}=s,l=pe(r,s),h=this.getVisibleItems(e,t,l),d=function(e,t){let i={};return e.forEach(function(e){i[e.id]=e}),i}(i);/*#__PURE__*/return o("div",{className:"rct-items",children:h.filter(e=>d[ee(e,n)]).map(e=>/*#__PURE__*/o(We,{item:e,keys:this.props.keys,order:l[ee(e,a)],dimensions:d[ee(e,n)].dimensions,selected:this.isSelected(e,n),canChangeGroup:void 0!==ee(e,"canChangeGroup")?ee(e,"canChangeGroup"):this.props.canChangeGroup,canMove:void 0!==ee(e,"canMove")?ee(e,"canMove"):this.props.canMove,canResizeLeft:He(e,this.props.canResize),canResizeRight:qe(e,this.props.canResize),canSelect:void 0!==ee(e,"canSelect")?ee(e,"canSelect"):this.props.canSelect,useResizeHandle:this.props.useResizeHandle,groupTops:this.props.groupTops,canvasTimeStart:this.props.canvasTimeStart,canvasTimeEnd:this.props.canvasTimeEnd,canvasWidth:this.props.canvasWidth,dragSnap:this.props.dragSnap,minResizeWidth:this.props.minResizeWidth,onResizing:this.props.itemResizing,onResized:this.props.itemResized,moveResizeValidator:this.props.moveResizeValidator,onDrag:this.props.itemDrag,onDrop:this.props.itemDrop,onItemDoubleClick:this.props.onItemDoubleClick,onContextMenu:this.props.onItemContextMenu,onSelect:this.props.itemSelect,itemRenderer:this.props.itemRenderer,scrollRef:this.props.scrollRef},ee(e,n)))})}}Ne.propTypes={groups:Q.oneOfType([Q.array,Q.object]).isRequired,items:Q.oneOfType([Q.array,Q.object]).isRequired,canvasTimeStart:Q.number.isRequired,canvasTimeEnd:Q.number.isRequired,canvasWidth:Q.number.isRequired,dragSnap:Q.number,minResizeWidth:Q.number,selectedItem:Q.oneOfType([Q.string,Q.number]),canChangeGroup:Q.bool.isRequired,canMove:Q.bool.isRequired,canResize:Q.oneOf([!0,!1,"left","right","both"]),canSelect:Q.bool,keys:Q.object.isRequired,moveResizeValidator:Q.func,itemSelect:Q.func,itemDrag:Q.func,itemDrop:Q.func,itemResizing:Q.func,itemResized:Q.func,onItemDoubleClick:Q.func,onItemContextMenu:Q.func,itemRenderer:Q.func,selected:Q.array,dimensionItems:Q.array,groupTops:Q.array,useResizeHandle:Q.bool,scrollRef:Q.object},Ne.defaultProps={selected:[]};class Fe extends t{constructor(e){super(e),this.onSidebarDown=e=>{this.props.handleSidebarResize.down(e)},this.state={width:e.width,resizing:!1}}shouldComponentUpdate(e,t){return!(e.keys===this.props.keys&&e.width===this.props.width&&e.height===this.props.height&&ie(e.groups,this.props.groups)&&ie(e.groupHeights,this.props.groupHeights)&&e.width===this.props.width)}renderGroupContent(t,i,s,r){return this.props.groupRenderer?/*#__PURE__*/e.createElement(this.props.groupRenderer,{group:t,isRightSidebar:i}):ee(t,i?r:s)}componentDidUpdate(e,t,i){this.props.handleSidebarResize.resizing&&!e.handleSidebarResize.resizing?(document.addEventListener("mousemove",this.props.handleSidebarResize.move),document.addEventListener("mouseup",this.props.handleSidebarResize.up)):!this.props.handleSidebarResize.resizing&&e.handleSidebarResize.resizing&&(document.removeEventListener("mousemove",this.props.handleSidebarResize.move),document.removeEventListener("mouseup",this.props.handleSidebarResize.up))}render(){const{groupHeights:e,height:t,width:i,isRightSidebar:s}=this.props,{groupIdKey:r,groupTitleKey:a,groupRightTitleKey:l}=this.props.keys,h={width:`${i}px`,height:`${t}px`},d={width:`${i}px`};let c=this.props.groups.map((t,i)=>/*#__PURE__*/o("div",{className:"rct-sidebar-row rct-sidebar-row-"+(i%2==0?"even":"odd"),style:{height:`${e[i]}px`,lineHeight:`${e[i]}px`},children:this.renderGroupContent(t,s,a,l)},ee(t,r)));/*#__PURE__*/return n("div",{className:"rct-sidebar"+(s?" rct-sidebar-right":""),style:h,children:[/*#__PURE__*/o("div",{style:d,children:c}),/*#__PURE__*/o("div",{className:"rct-sidebar-resize",onMouseDown:this.onSidebarDown})]})}}Fe.propTypes={groups:Q.oneOfType([Q.array,Q.object]).isRequired,width:Q.number.isRequired,height:Q.number.isRequired,groupHeights:Q.array.isRequired,keys:Q.object.isRequired,groupRenderer:Q.func,isRightSidebar:Q.bool,handleSidebarResize:Q.object};const je={getTimelineState:()=>{console.warn('"getTimelineState" default func is being used')},getLeftOffsetFromDate:()=>{console.warn('"getLeftOffsetFromDate" default func is being used')},getDateFromLeftOffsetPosition:()=>{console.warn('"getDateFromLeftOffsetPosition" default func is being used')},showPeriod:()=>{console.warn('"showPeriod" default func is being used')}},{Consumer:$e,Provider:Ke}=/*#__PURE__*/e.createContext(je);class Ue extends e.Component{constructor(e){super(e),this.getTimelineState=()=>{const{visibleTimeStart:e,visibleTimeEnd:t,canvasTimeStart:i,canvasTimeEnd:s,canvasWidth:r,timelineUnit:n,timelineWidth:o}=this.props;return{visibleTimeStart:e,visibleTimeEnd:t,canvasTimeStart:i,canvasTimeEnd:s,canvasWidth:r,timelineUnit:n,timelineWidth:o}},this.getLeftOffsetFromDate=e=>{const{canvasTimeStart:t,canvasTimeEnd:i,canvasWidth:s}=this.props;return ae(t,i,s,e)},this.getDateFromLeftOffsetPosition=e=>{const{canvasTimeStart:t,canvasTimeEnd:i,canvasWidth:s}=this.props;return le(t,i,s,e)},this.state={timelineContext:{getTimelineState:this.getTimelineState,getLeftOffsetFromDate:this.getLeftOffsetFromDate,getDateFromLeftOffsetPosition:this.getDateFromLeftOffsetPosition,showPeriod:this.props.showPeriod}}}render(){/*#__PURE__*/return o(Ke,{value:this.state.timelineContext,children:this.props.children})}}Ue.propTypes={children:Q.element.isRequired,visibleTimeStart:Q.number.isRequired,visibleTimeEnd:Q.number.isRequired,canvasTimeStart:Q.number.isRequired,canvasTimeEnd:Q.number.isRequired,canvasWidth:Q.number.isRequired,showPeriod:Q.func.isRequired,timelineUnit:Q.string.isRequired,timelineWidth:Q.number.isRequired};const Ge=$e,Ye={canvasTimeStart:Q.number.isRequired,canvasTimeEnd:Q.number.isRequired,canvasWidth:Q.number.isRequired,lineCount:Q.number.isRequired,minUnit:Q.string.isRequired,timeSteps:Q.object.isRequired,height:Q.number.isRequired,verticalLineClassNamesForTime:Q.func};class Ae extends t{shouldComponentUpdate(e){return!(e.canvasTimeStart===this.props.canvasTimeStart&&e.canvasTimeEnd===this.props.canvasTimeEnd&&e.canvasWidth===this.props.canvasWidth&&e.lineCount===this.props.lineCount&&e.minUnit===this.props.minUnit&&e.timeSteps===this.props.timeSteps&&e.height===this.props.height&&e.verticalLineClassNamesForTime===this.props.verticalLineClassNamesForTime)}render(){const{canvasTimeStart:e,canvasTimeEnd:t,minUnit:i,timeSteps:s,height:r,verticalLineClassNamesForTime:n,getLeftOffsetFromDate:a}=this.props;let l=[];return he(e,t,i,s,(e,t)=>{const s=e.get("day"===i?"date":i)===("day"===i?1:0);let h=[];n&&(h=n(1e3*e.unix(),1e3*t.unix()-1));const d="rct-vl"+(s?" rct-vl-first":"")+("day"===i||"hour"===i||"minute"===i?` rct-day-${e.day()} `:" ")+h.join(" "),c=a(e.valueOf()),p=a(t.valueOf());l.push(/*#__PURE__*/o("div",{className:d,style:{pointerEvents:"none",top:"0px",left:`${c}px`,width:p-c+"px",height:`${r}px`}},`line-${e.valueOf()}`))}),/*#__PURE__*/o("div",{className:"rct-vertical-lines",children:l})}}Ae.propTypes=h({},Ye,{getLeftOffsetFromDate:Q.func.isRequired});const _e=e=>{let t=h({},e);/*#__PURE__*/return o(Ge,{children:({getLeftOffsetFromDate:e})=>/*#__PURE__*/o(Ae,h({getLeftOffsetFromDate:e},t))})};_e.defaultProps=h({},Ye);class Be extends t{constructor(...e){super(...e),this.handleMouseDown=e=>{this.originClickX=e.clientX},this.handleMouseUp=e=>{Math.abs(this.originClickX-e.clientX)>this.props.clickTolerance&&(this.cancelClick=!0)},this.handleClick=e=>{this.cancelClick||this.props.onClick(e),this.cancelClick=!1,this.originClickX=null}}render(){const t=e.Children.only(this.props.children);/*#__PURE__*/return e.cloneElement(t,{onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:this.handleClick})}}Be.propTypes={children:Q.element.isRequired,onClick:Q.func.isRequired,clickTolerance:Q.number.isRequired};class Ve extends t{render(){const{onContextMenu:e,onDoubleClick:t,isEvenRow:i,style:s,onClick:r,clickTolerance:n,horizontalLineClassNamesForGroup:a,group:l}=this.props;let h=[];return a&&(h=a(l)),/*#__PURE__*/o(Be,{clickTolerance:n,onClick:r,children:/*#__PURE__*/o("div",{onContextMenu:e,onDoubleClick:t,className:(i?"rct-hl-even ":"rct-hl-odd ")+(h?h.join(" "):""),style:s})})}}Ve.propTypes={onClick:Q.func.isRequired,onDoubleClick:Q.func.isRequired,onContextMenu:Q.func.isRequired,isEvenRow:Q.bool.isRequired,style:Q.object.isRequired,clickTolerance:Q.number.isRequired,group:Q.object.isRequired,horizontalLineClassNamesForGroup:Q.func};class Xe extends t{shouldComponentUpdate(e){return!(e.canvasWidth===this.props.canvasWidth&&e.lineCount===this.props.lineCount&&e.groupHeights===this.props.groupHeights&&e.groups===this.props.groups)}render(){const{canvasWidth:e,lineCount:t,groupHeights:i,onRowClick:s,onRowDoubleClick:r,clickTolerance:n,groups:a,horizontalLineClassNamesForGroup:l,onRowContextClick:h}=this.props;let d=[];for(let c=0;c<t;c++)d.push(/*#__PURE__*/o(Ve,{clickTolerance:n,onContextMenu:e=>h(e,c),onClick:e=>s(e,c),onDoubleClick:e=>r(e,c),isEvenRow:c%2==0,group:a[c],horizontalLineClassNamesForGroup:l,style:{width:`${e}px`,height:`${i[c]}px`}},`horizontal-line-${c}`));/*#__PURE__*/return o("div",{className:"rct-horizontal-lines",children:d})}}Xe.propTypes={canvasWidth:Q.number.isRequired,lineCount:Q.number.isRequired,groupHeights:Q.array.isRequired,onRowClick:Q.func.isRequired,onRowDoubleClick:Q.func.isRequired,clickTolerance:Q.number.isRequired,groups:Q.array.isRequired,horizontalLineClassNamesForGroup:Q.func,onRowContextClick:Q.func.isRequired};class Ze extends t{constructor(){super(),this.handleScroll=()=>{this.props.onScroll(this.scrollComponent.scrollLeft)},this.refHandler=e=>{this.scrollComponent=e,this.props.scrollRef(e),e&&e.addEventListener("wheel",this.handleWheel,{passive:!1})},this.handleWheel=e=>{if(e.ctrlKey||e.metaKey){e.preventDefault();const t=Ce(e.currentTarget);this.props.onWheelZoom(e.ctrlKey?1:e.metaKey?3:1,e.clientX-t.x,e.deltaY)}else e.shiftKey&&(e.preventDefault(),this.props.onScroll(this.scrollComponent.scrollLeft+(e.deltaY||e.deltaX)))},this.handleMouseDown=e=>{0===e.button&&(this.dragStartPosition=e.pageX,this.dragLastPosition=e.pageX,this.setState({isDragging:!0}))},this.handleMouseMove=e=>{this.state.isDragging&&!this.props.isInteractingWithItem&&(this.props.onScroll(this.scrollComponent.scrollLeft+this.dragLastPosition-e.pageX),this.dragLastPosition=e.pageX)},this.handleMouseUp=()=>{this.dragStartPosition=null,this.dragLastPosition=null,this.setState({isDragging:!1})},this.handleMouseLeave=()=>{this.dragStartPosition=null,this.dragLastPosition=null,this.setState({isDragging:!1})},this.handleTouchStart=e=>{if(2===e.touches.length)e.preventDefault(),this.lastTouchDistance=Math.abs(e.touches[0].screenX-e.touches[1].screenX),this.singleTouchStart=null,this.lastSingleTouch=null;else if(1===e.touches.length){e.preventDefault();let t=e.touches[0].clientX,i=e.touches[0].clientY;this.lastTouchDistance=null,this.singleTouchStart={x:t,y:i,screenY:window.pageYOffset},this.lastSingleTouch={x:t,y:i,screenY:window.pageYOffset}}},this.handleTouchMove=e=>{const{isInteractingWithItem:t,width:i,onZoom:s}=this.props;if(t)e.preventDefault();else if(this.lastTouchDistance&&2===e.touches.length){e.preventDefault();let t=Math.abs(e.touches[0].screenX-e.touches[1].screenX),r=Ce(e.currentTarget),n=(e.touches[0].screenX+e.touches[1].screenX)/2-r.x;0!==t&&0!==this.lastTouchDistance&&(s(this.lastTouchDistance/t,n/i),this.lastTouchDistance=t)}else if(this.lastSingleTouch&&1===e.touches.length){e.preventDefault();let t=e.touches[0].clientX,i=e.touches[0].clientY,s=t-this.lastSingleTouch.x,r=t-this.singleTouchStart.x,n=i-this.singleTouchStart.y;this.lastSingleTouch={x:t,y:i};let o=3*Math.abs(r)>Math.abs(n),a=3*Math.abs(n)>Math.abs(r);0!==s&&o&&this.props.onScroll(this.scrollComponent.scrollLeft-s),a&&window.scrollTo(window.pageXOffset,this.singleTouchStart.screenY-n)}},this.handleTouchEnd=()=>{this.lastTouchDistance&&(this.lastTouchDistance=null),this.lastSingleTouch&&(this.lastSingleTouch=null,this.singleTouchStart=null)},this.state={isDragging:!1}}componentWillUnmount(){this.scrollComponent&&this.scrollComponent.removeEventListener("wheel",this.handleWheel)}render(){const{width:e,height:t,children:i}=this.props,{isDragging:s}=this.state;/*#__PURE__*/return o("div",{ref:this.refHandler,"data-testid":"scroll-element",className:"rct-scroll",style:{width:`${e}px`,height:`${t+20}px`,cursor:s?"move":"default",position:"relative"},onMouseDown:this.handleMouseDown,onMouseMove:this.handleMouseMove,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseLeave,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd,onScroll:this.handleScroll,children:i})}}Ze.propTypes={children:Q.element.isRequired,width:Q.number.isRequired,height:Q.number.isRequired,traditionalZoom:Q.bool.isRequired,scrollRef:Q.func.isRequired,isInteractingWithItem:Q.bool.isRequired,onZoom:Q.func.isRequired,onWheelZoom:Q.func.isRequired,onScroll:Q.func.isRequired};const Je={subscribeToMouseOver:()=>{console.warn('"subscribeToMouseOver" default func is being used')}},{Consumer:Qe,Provider:et}=/*#__PURE__*/e.createContext(Je),tt=et,it=Qe,st={markers:[],subscribeMarker:()=>(console.warn("default subscribe marker used"),se)},{Consumer:rt,Provider:nt}=/*#__PURE__*/e.createContext(st);let ot=0;class at extends e.Component{constructor(...e){super(...e),this.handleSubscribeToMarker=e=>(e=h({},e,{id:(ot+=1,ot+1)}),this.setState(t=>({markers:[...t.markers,e]})),{unsubscribe:()=>{this.setState(t=>({markers:t.markers.filter(t=>t.id!==e.id)}))},getMarker:()=>e}),this.handleUpdateMarker=e=>{const t=this.state.markers.findIndex(t=>t.id===e.id);t<0||this.setState(i=>({markers:[...i.markers.slice(0,t),e,...i.markers.slice(t+1)]}))},this.state={markers:[],subscribeMarker:this.handleSubscribeToMarker,updateMarker:this.handleUpdateMarker}}render(){/*#__PURE__*/return o(nt,{value:this.state,children:this.props.children})}}at.propTypes={children:Q.element.isRequired};const lt=rt,ht={position:"absolute",top:0,bottom:0,width:"2px",backgroundColor:"black",pointerEvents:"none"},dt=e=>h({},ht,{left:e}),ct=e=>function({styles:t}){/*#__PURE__*/return o("div",{style:t,"data-testid":e})},pt=ct("default-today-line");class ut extends e.Component{constructor(...e){super(...e),this.state={date:Date.now()}}componentDidMount(){this.intervalToken=this.createIntervalUpdater(this.props.interval)}componentDidUpdate(e){e.interval!==this.props.interval&&(clearInterval(this.intervalToken),this.intervalToken=this.createIntervalUpdater(this.props.interval))}createIntervalUpdater(e){return setInterval(()=>{this.setState({date:Date.now()})},e)}componentWillUnmount(){clearInterval(this.intervalToken)}render(){const{date:e}=this.state,t=this.props.getLeftOffsetFromDate(e),i=dt(t);return this.props.renderer({styles:i,date:e})}}ut.propTypes={getLeftOffsetFromDate:Q.func.isRequired,renderer:Q.func,interval:Q.number.isRequired},ut.defaultProps={renderer:pt};const mt=ct("default-customer-marker-id");class gt extends e.Component{render(){const{date:e}=this.props,t=this.props.getLeftOffsetFromDate(e),i=dt(t);return this.props.renderer({styles:i,date:e})}}gt.propTypes={getLeftOffsetFromDate:Q.func.isRequired,renderer:Q.func,date:Q.number.isRequired},gt.defaultProps={renderer:mt};const ft=ct("default-cursor-marker");class vt extends e.Component{constructor(){super(),this.handleCanvasMouseOver=({leftOffset:e,date:t,isCursorOverCanvas:i})=>{this.setState({leftOffset:e,date:t,isShowingCursor:i})},this.state={leftOffset:0,date:0,isShowingCursor:!1}}componentDidMount(){this.unsubscribe=this.props.subscribeToCanvasMouseOver(this.handleCanvasMouseOver)}componentWillUnmount(){null!=this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}render(){const{isShowingCursor:e,leftOffset:t,date:i}=this.state;if(!e)return null;const s=dt(t);return this.props.renderer({styles:s,date:i})}}vt.propTypes={subscribeToCanvasMouseOver:Q.func.isRequired,renderer:Q.func},vt.defaultProps={renderer:ft};const bt=e=>/*#__PURE__*/o(it,{children:({subscribeToMouseOver:t})=>/*#__PURE__*/o(vt,h({subscribeToCanvasMouseOver:t},e))});bt.displayName="CursorMarkerWrapper";const yt=()=>/*#__PURE__*/o(Ge,{children:({getLeftOffsetFromDate:e})=>/*#__PURE__*/o(lt,{children:({markers:t})=>t.map(t=>{switch(t.type){case"Today":/*#__PURE__*/return o(ut,{getLeftOffsetFromDate:e,renderer:t.renderer,interval:t.interval},t.id);case"Custom":/*#__PURE__*/return o(gt,{renderer:t.renderer,date:t.date,getLeftOffsetFromDate:e},t.id);case"Cursor":/*#__PURE__*/return o(bt,{renderer:t.renderer,getLeftOffsetFromDate:e},t.id);default:return null}})})}),Tt={position:"absolute",left:0,right:0,top:0,bottom:0};class St extends e.Component{constructor(...e){super(...e),this.handleMouseMove=e=>{if(null!=this.subscription){const{pageX:t}=e,{left:i}=this.containerEl.getBoundingClientRect(),s=t-i,r=this.props.getDateFromLeftOffsetPosition(s);this.subscription({leftOffset:s,date:r,isCursorOverCanvas:!0})}},this.handleMouseLeave=()=>{null!=this.subscription&&this.subscription({leftOffset:0,date:0,isCursorOverCanvas:!1})},this.handleMouseMoveSubscribe=e=>(this.subscription=e,()=>{this.subscription=null}),this.state={subscribeToMouseOver:this.handleMouseMoveSubscribe}}render(){/*#__PURE__*/return o(tt,{value:this.state,children:/*#__PURE__*/n("div",{style:Tt,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,ref:e=>this.containerEl=e,children:[/*#__PURE__*/o(yt,{}),this.props.children]})})}}St.propTypes={getDateFromLeftOffsetPosition:Q.func.isRequired,children:Q.node};const Rt=e=>/*#__PURE__*/o(Ge,{children:({getDateFromLeftOffsetPosition:t})=>/*#__PURE__*/o(St,h({getDateFromLeftOffsetPosition:t},e))}),Ct={year:{long:"YYYY",mediumLong:"YYYY",medium:"YYYY",short:"YY"},month:{long:"MMMM YYYY",mediumLong:"MMMM",medium:"MMMM",short:"MM/YY"},week:{long:"w",mediumLong:"w",medium:"w",short:"w"},day:{long:"dddd, LL",mediumLong:"dddd, LL",medium:"dd D",short:"D"},hour:{long:"dddd, LL, HH:00",mediumLong:"L, HH:00",medium:"HH:00",short:"HH"},minute:{long:"HH:mm",mediumLong:"HH:mm",medium:"HH:mm",short:"mm"},second:{long:"mm:ss",mediumLong:"mm:ss",medium:"mm:ss",short:"ss"}},zt={registerScroll:()=>(console.warn("default registerScroll header used"),se),rightSidebarWidth:0,leftSidebarWidth:150,timeSteps:{}},{Consumer:Mt,Provider:It}=/*#__PURE__*/e.createContext(zt);class kt extends e.Component{render(){/*#__PURE__*/return o(It,{value:{rightSidebarWidth:this.props.rightSidebarWidth,leftSidebarWidth:this.props.leftSidebarWidth,timeSteps:this.props.timeSteps,registerScroll:this.props.registerScroll},children:this.props.children})}}kt.propTypes={children:Q.element.isRequired,rightSidebarWidth:Q.number,leftSidebarWidth:Q.number.isRequired,timeSteps:Q.object.isRequired,registerScroll:Q.func.isRequired};const Dt=Mt;class wt extends e.PureComponent{constructor(...e){super(...e),this.getRootProps=(e={})=>{const{style:t}=e;return{style:h({},t,{width:"right"===this.props.variant?this.props.rightSidebarWidth:this.props.leftSidebarWidth})}},this.getStateAndHelpers=()=>({getRootProps:this.getRootProps,data:this.props.headerData})}render(){const e=this.getStateAndHelpers();/*#__PURE__*/return o(this.props.children,h({},e))}}wt.propTypes={children:Q.func.isRequired,rightSidebarWidth:Q.number,leftSidebarWidth:Q.number.isRequired,variant:Q.string,headerData:Q.object};const xt=({children:e,variant:t,headerData:i})=>/*#__PURE__*/o(Dt,{children:({leftSidebarWidth:s,rightSidebarWidth:r})=>/*#__PURE__*/o(wt,{leftSidebarWidth:s,rightSidebarWidth:r,children:e,variant:t,headerData:i})});xt.propTypes={children:Q.func.isRequired,variant:Q.string,headerData:Q.object},xt.defaultProps={variant:"left",children:({getRootProps:e})=>/*#__PURE__*/o("div",h({"data-testid":"sidebarHeader"},e()))},xt.secretKey="SidebarHeader";class Et extends e.Component{constructor(e){super(e),this.getRootStyle=()=>h({},this.props.style,{display:"flex",width:"100%"}),this.getCalendarHeaderStyle=()=>{const{leftSidebarWidth:e,rightSidebarWidth:t,calendarHeaderStyle:i}=this.props;return h({},i,{overflow:"hidden",width:`calc(100% - ${e+t}px)`})},this.handleRootRef=e=>{this.props.headerRef&&this.props.headerRef(e)},this.isSidebarHeader=e=>void 0!==e.type&&e.type.secretKey===xt.secretKey}render(){let t,i,s=[];const r=Array.isArray(this.props.children)?this.props.children.filter(e=>e):[this.props.children];return e.Children.map(r,e=>{this.isSidebarHeader(e)?"right"===e.props.variant?t=e:i=e:s.push(e)}),i||(i=/*#__PURE__*/o(xt,{})),!t&&this.props.rightSidebarWidth&&(t=/*#__PURE__*/o(xt,{variant:"right"})),/*#__PURE__*/n("div",{ref:this.handleRootRef,"data-testid":"headerRootDiv",style:this.getRootStyle(),className:a("rct-header-root",this.props.className),children:[i,/*#__PURE__*/o("div",{ref:this.props.registerScroll,style:this.getCalendarHeaderStyle(),className:a("rct-calendar-header",this.props.calendarHeaderClassName),"data-testid":"headerContainer",children:s}),t]})}}Et.propTypes={registerScroll:Q.func.isRequired,leftSidebarWidth:Q.number.isRequired,rightSidebarWidth:Q.number.isRequired,style:Q.object,children:Q.node,className:Q.string,calendarHeaderStyle:Q.object,calendarHeaderClassName:Q.string,headerRef:Q.func};const Lt=({children:e,style:t,className:i,calendarHeaderStyle:s,calendarHeaderClassName:r})=>/*#__PURE__*/o(Dt,{children:({leftSidebarWidth:n,rightSidebarWidth:a,registerScroll:l})=>/*#__PURE__*/o(Et,{leftSidebarWidth:n,rightSidebarWidth:a,registerScroll:l,style:t,className:i,calendarHeaderStyle:s,calendarHeaderClassName:r,children:e})});Lt.propTypes={style:Q.object,children:Q.node,className:Q.string,calendarHeaderStyle:Q.object,calendarHeaderClassName:Q.string},Lt.secretKey="TimelineHeaders";class Ot extends e.Component{constructor(e){super(e),this.getHeaderIntervals=({canvasTimeStart:e,canvasTimeEnd:t,unit:i,timeSteps:s,getLeftOffsetFromDate:r})=>{const n=[];return he(e,t,i,s,(e,t)=>{const i=r(e.valueOf()),s=r(t.valueOf());n.push({startTime:e,endTime:t,labelWidth:s-i,left:i})}),n},this.getRootProps=(e={})=>{const{style:t}=e;return{style:Object.assign({},t||{},{position:"relative",width:this.props.canvasWidth,height:this.props.height})}},this.getIntervalProps=(e={})=>{const{interval:t,style:i}=e;if(!t)throw new Error("you should provide interval to the prop getter");const{startTime:s,labelWidth:r,left:n}=t;return{style:this.getIntervalStyle({style:i,startTime:s,labelWidth:r,canvasTimeStart:this.props.canvasTimeStart,unit:this.props.unit,left:n}),key:`label-${s.valueOf()}`}},this.getIntervalStyle=({left:e,labelWidth:t,style:i})=>h({},i,{left:e,width:t,position:"absolute"}),this.getStateAndHelpers=()=>{const{canvasTimeStart:e,canvasTimeEnd:t,unit:i,showPeriod:s,timelineWidth:r,visibleTimeStart:n,visibleTimeEnd:o,headerData:a}=this.props;return{timelineContext:{timelineWidth:r,visibleTimeStart:n,visibleTimeEnd:o,canvasTimeStart:e,canvasTimeEnd:t},headerContext:{unit:i,intervals:this.state.intervals},getRootProps:this.getRootProps,getIntervalProps:this.getIntervalProps,showPeriod:s,data:a}};const{canvasTimeStart:t,canvasTimeEnd:i,canvasWidth:s,unit:r,timeSteps:n,showPeriod:o,getLeftOffsetFromDate:a}=e,l=this.getHeaderIntervals({canvasTimeStart:t,canvasTimeEnd:i,canvasWidth:s,unit:r,timeSteps:n,showPeriod:o,getLeftOffsetFromDate:a});this.state={intervals:l}}shouldComponentUpdate(e){return e.canvasTimeStart!==this.props.canvasTimeStart||e.canvasTimeEnd!==this.props.canvasTimeEnd||e.canvasWidth!==this.props.canvasWidth||e.unit!==this.props.unit||e.timeSteps!==this.props.timeSteps||e.showPeriod!==this.props.showPeriod||e.children!==this.props.children||e.headerData!==this.props.headerData}componentWillReceiveProps(e){if(e.canvasTimeStart!==this.props.canvasTimeStart||e.canvasTimeEnd!==this.props.canvasTimeEnd||e.canvasWidth!==this.props.canvasWidth||e.unit!==this.props.unit||e.timeSteps!==this.props.timeSteps||e.showPeriod!==this.props.showPeriod){const{canvasTimeStart:t,canvasTimeEnd:i,canvasWidth:s,unit:r,timeSteps:n,showPeriod:o,getLeftOffsetFromDate:a}=e,l=this.getHeaderIntervals({canvasTimeStart:t,canvasTimeEnd:i,canvasWidth:s,unit:r,timeSteps:n,showPeriod:o,getLeftOffsetFromDate:a});this.setState({intervals:l})}}render(){const e=this.getStateAndHelpers();/*#__PURE__*/return o(this.props.children,h({},e))}}Ot.propTypes={children:Q.func.isRequired,unit:Q.string.isRequired,timeSteps:Q.object.isRequired,visibleTimeStart:Q.number.isRequired,visibleTimeEnd:Q.number.isRequired,canvasTimeStart:Q.number.isRequired,canvasTimeEnd:Q.number.isRequired,canvasWidth:Q.number.isRequired,showPeriod:Q.func.isRequired,headerData:Q.object,getLeftOffsetFromDate:Q.func.isRequired,height:Q.number.isRequired};const Pt=({children:e,unit:t,headerData:i,height:s})=>/*#__PURE__*/o(Ge,{children:({getTimelineState:r,showPeriod:n,getLeftOffsetFromDate:a})=>{const l=r();/*#__PURE__*/return o(Dt,{children:({timeSteps:r})=>/*#__PURE__*/o(Ot,h({children:e,timeSteps:r,showPeriod:n,unit:t||l.timelineUnit},l,{headerData:i,getLeftOffsetFromDate:a,height:s}))})}});Pt.propTypes={children:Q.func.isRequired,unit:Q.string,headerData:Q.object,height:Q.number},Pt.defaultProps={height:30};var Wt=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function Ht(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!((s=e[i])===(r=t[i])||Wt(s)&&Wt(r)))return!1;var s,r;return!0}function qt(e,t){void 0===t&&(t=Ht);var i=null;function s(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];if(i&&i.lastThis===this&&t(s,i.lastArgs))return i.lastResult;var n=e.apply(this,s);return i={lastResult:n,lastArgs:s,lastThis:this},n}return s.clear=function(){i=null},s}class Nt extends e.PureComponent{constructor(...e){super(...e),this.onIntervalClick=()=>{const{primaryHeader:e,interval:t,unit:i,showPeriod:s}=this.props;if(e){const e=ce(i);s(t.startTime.clone().startOf(e),t.startTime.clone().endOf(e))}else s(t.startTime,t.endTime)},this.getIntervalProps=(e={})=>h({},this.props.getIntervalProps(h({interval:this.props.interval},e)),{onClick:re(this.onIntervalClick,e.onClick)})}render(){const{intervalText:e,interval:t,intervalRenderer:i,headerData:s}=this.props;return i?/*#__PURE__*/o(i,{getIntervalProps:this.getIntervalProps,intervalContext:{interval:t,intervalText:e},data:s}):/*#__PURE__*/o("div",h({"data-testid":"dateHeaderInterval"},this.getIntervalProps({}),{className:"rct-dateHeader "+(this.props.primaryHeader?"rct-dateHeader-primary":""),children:/*#__PURE__*/o("span",{children:e})}))}}function Ft({headerContext:{intervals:e,unit:t},getRootProps:i,getIntervalProps:s,showPeriod:r,data:{style:n,intervalRenderer:a,className:l,getLabelFormat:d,unitProp:c,headerData:p}}){/*#__PURE__*/return o("div",h({"data-testid":"dateHeader",className:l},i({style:n}),{children:e.map(e=>{const i=d([e.startTime,e.endTime],t,e.labelWidth);/*#__PURE__*/return o(Nt,{unit:t,interval:e,showPeriod:r,intervalText:i,primaryHeader:"primaryHeader"===c,getIntervalProps:s,intervalRenderer:a,headerData:p},`label-${e.startTime.valueOf()}`)})}))}Nt.propTypes={intervalRenderer:Q.func,unit:Q.string.isRequired,interval:Q.object.isRequired,showPeriod:Q.func.isRequired,intervalText:Q.string.isRequired,primaryHeader:Q.bool.isRequired,getIntervalProps:Q.func.isRequired,headerData:Q.object};class jt extends e.Component{constructor(...e){super(...e),this.getHeaderUnit=()=>"primaryHeader"===this.props.unit?ce(this.props.timelineUnit):this.props.unit?this.props.unit:this.props.timelineUnit,this.getRootStyle=qt(e=>h({height:30},e)),this.getLabelFormat=(e,t,i)=>{const{labelFormat:s}=this.props;if("string"==typeof s)return e[0].format(s);if("function"==typeof s)return s(e,t,i);throw new Error("labelFormat should be function or string")},this.getHeaderData=qt((e,t,i,s,r,n)=>({intervalRenderer:e,style:t,className:i,getLabelFormat:s,unitProp:r,headerData:n}))}render(){const e=this.getHeaderUnit(),{height:t}=this.props;/*#__PURE__*/return o(Pt,{unit:e,height:t,headerData:this.getHeaderData(this.props.intervalRenderer,this.getRootStyle(this.props.style),this.props.className,this.getLabelFormat,this.props.unit,this.props.headerData),children:Ft})}}jt.propTypes={unit:Q.string,style:Q.object,className:Q.string,timelineUnit:Q.string,labelFormat:Q.oneOfType([Q.func,Q.objectOf(Q.objectOf(Q.string)),Q.string]).isRequired,intervalRenderer:Q.func,headerData:Q.object,height:Q.number};const $t=({unit:e,labelFormat:t,style:i,className:s,intervalRenderer:r,headerData:n,height:a})=>/*#__PURE__*/o(Ge,{children:({getTimelineState:l})=>{const h=l();/*#__PURE__*/return o(jt,{timelineUnit:h.timelineUnit,unit:e,labelFormat:t,style:i,className:s,intervalRenderer:r,headerData:n,height:a})}});$t.propTypes={style:Q.object,className:Q.string,unit:Q.string,labelFormat:Q.oneOfType([Q.func,Q.objectOf(Q.objectOf(Q.string)),Q.string]),intervalRenderer:Q.func,headerData:Q.object,height:Q.number},$t.defaultProps={labelFormat:function([e,t],i,s,r=Ct){let n;return n=s>=150?r[i].long:s>=100?r[i].mediumLong:s>=50?r[i].medium:r[i].short,e.format(n)}};class Kt extends t{getChildContext(){return{getTimelineContext:()=>this.getTimelineContext()}}constructor(t){super(t),this.getTimelineContext=()=>{const{width:e,visibleTimeStart:t,visibleTimeEnd:i,canvasTimeStart:s,canvasTimeEnd:r}=this.state;return{timelineWidth:e,visibleTimeStart:t,visibleTimeEnd:i,canvasTimeStart:s,canvasTimeEnd:r}},this.getTimelineUnit=()=>{const{width:e,visibleTimeStart:t,visibleTimeEnd:i}=this.state,{timeSteps:s}=this.props;return de(i-t,e,s)},this.resize=(e=this.props)=>{const{width:t}=this.container.getBoundingClientRect();let i=t-e.sidebarWidth-e.rightSidebarWidth;const s=Te(i),{dimensionItems:r,height:n,groupHeights:o,groupTops:a}=ye(e.items,e.groups,s,this.state.canvasTimeStart,this.state.canvasTimeEnd,e.keys,e.lineHeight,e.itemHeightRatio,e.stackItems,this.state.draggingItem,this.state.resizingItem,this.state.dragTime,this.state.resizingEdge,this.state.resizeTime,this.state.newGroupOrder);this.setState({width:i,dimensionItems:r,height:n,groupHeights:o,groupTops:a}),this.scrollComponent.scrollLeft=i,this.scrollHeaderRef.scrollLeft=i},this.onScroll=e=>{const t=this.state.visibleTimeEnd-this.state.visibleTimeStart,i=this.state.canvasTimeStart+t*e/this.state.width;this.state.visibleTimeStart===i&&this.state.visibleTimeEnd===i+t||this.props.onTimeChange(i,i+t,this.updateScrollCanvas,this.getTimelineUnit())},this.updateScrollCanvas=(e,t,i,s=this.props.items,r=this.props.groups)=>{this.setState(Re(e,t,i,s,r,this.props,this.state))},this.handleWheelZoom=(e,t,i)=>{this.changeZoom(1+e*i/500,t/this.state.width)},this.changeZoom=(e,t=.5)=>{const{minZoom:i,maxZoom:s}=this.props,r=this.state.visibleTimeEnd-this.state.visibleTimeStart,n=Math.min(Math.max(Math.round(r*e),i),s),o=Math.round(this.state.visibleTimeStart+(r-n)*t);this.props.onTimeChange(o,o+n,this.updateScrollCanvas,this.getTimelineUnit())},this.showPeriod=(e,t)=>{let i=e.valueOf(),s=t.valueOf()-i;s<this.props.minZoom||this.props.onTimeChange(i,i+s,this.updateScrollCanvas,this.getTimelineUnit())},this.selectItem=(e,t,i)=>{if(this.isItemSelected(e)||this.props.itemTouchSendsClick&&"touch"===t){if(e&&this.props.onItemClick){const t=this.timeFromItemEvent(i);this.props.onItemClick(e,i,t)}}else if(this.setState({selectedItem:e}),e&&this.props.onItemSelect){const t=this.timeFromItemEvent(i);this.props.onItemSelect(e,i,t)}else null===e&&this.props.onItemDeselect&&this.props.onItemDeselect(i)},this.doubleClickItem=(e,t)=>{if(this.props.onItemDoubleClick){const i=this.timeFromItemEvent(t);this.props.onItemDoubleClick(e,t,i)}},this.contextMenuClickItem=(e,t)=>{if(this.props.onItemContextMenu){const i=this.timeFromItemEvent(t);this.props.onItemContextMenu(e,t,i)}},this.getTimeFromRowClickEvent=e=>{const{dragSnap:t}=this.props,{width:i,canvasTimeStart:s,canvasTimeEnd:r}=this.state,{offsetX:n}=e.nativeEvent;let o=le(s,r,Te(i),n);return o=Math.floor(o/t)*t,o},this.timeFromItemEvent=e=>{const{width:t,visibleTimeStart:i,visibleTimeEnd:s}=this.state,{dragSnap:r}=this.props,n=this.scrollComponent,{left:o}=n.getBoundingClientRect();let a=Math.round(i+(e.clientX-o)/t*(s-i));return a=Math.floor(a/r)*r,a},this.dragItem=(e,t,i)=>{let s=this.props.groups[i];this.setState({draggingItem:e,dragTime:t,newGroupOrder:i,dragGroupTitle:s?ee(s,this.props.keys.groupLabelKey):""}),this.updatingItem({eventType:"move",itemId:e,time:t,newGroupOrder:i})},this.dropItem=(e,t,i)=>{this.setState({draggingItem:null,dragTime:null,dragGroupTitle:null}),this.props.onItemMove&&this.props.onItemMove(e,t,i)},this.resizingItem=(e,t,i)=>{this.setState({resizingItem:e,resizingEdge:i,resizeTime:t}),this.updatingItem({eventType:"resize",itemId:e,time:t,edge:i})},this.resizedItem=(e,t,i,s)=>{this.setState({resizingItem:null,resizingEdge:null,resizeTime:null}),this.props.onItemResize&&0!==s&&this.props.onItemResize(e,t,i)},this.updatingItem=({eventType:e,itemId:t,time:i,edge:s,newGroupOrder:r})=>{this.props.onItemDrag&&this.props.onItemDrag({eventType:e,itemId:t,time:i,edge:s,newGroupOrder:r})},this.handleRowClick=(e,t)=>{if(this.hasSelectedItem()&&this.selectItem(null),null==this.props.onCanvasClick)return;const i=this.getTimeFromRowClickEvent(e),s=ee(this.props.groups[t],this.props.keys.groupIdKey);this.props.onCanvasClick(s,i,e)},this.handleRowDoubleClick=(e,t)=>{if(null==this.props.onCanvasDoubleClick)return;const i=this.getTimeFromRowClickEvent(e),s=ee(this.props.groups[t],this.props.keys.groupIdKey);this.props.onCanvasDoubleClick(s,i,e)},this.handleScrollContextMenu=(e,t)=>{if(null==this.props.onCanvasContextMenu)return;const i=this.getTimeFromRowClickEvent(e),s=ee(this.props.groups[t],this.props.keys.groupIdKey);this.props.onCanvasContextMenu&&(e.preventDefault(),this.props.onCanvasContextMenu(s,i,e))},this.handleHeaderRef=e=>{this.scrollHeaderRef=e,this.props.headerRef(e)},this.isTimelineHeader=e=>void 0!==e.type&&e.type.secretKey===Lt.secretKey,this.renderHeaders=()=>{if(this.props.children){let t;if(e.Children.map(this.props.children,e=>{this.isTimelineHeader(e)&&(t=e)}),t)return t}/*#__PURE__*/return n(Lt,{children:[/*#__PURE__*/o($t,{unit:"primaryHeader"}),/*#__PURE__*/o($t,{})]})},this.getScrollElementRef=e=>{this.props.scrollRef(e),this.scrollComponent=e},this.getSelected=this.getSelected.bind(this),this.hasSelectedItem=this.hasSelectedItem.bind(this),this.isItemSelected=this.isItemSelected.bind(this);let i=null,s=null;if(this.props.defaultTimeStart&&this.props.defaultTimeEnd)i=this.props.defaultTimeStart.valueOf(),s=this.props.defaultTimeEnd.valueOf();else{if(!this.props.visibleTimeStart||!this.props.visibleTimeEnd)throw new Error('You must provide either "defaultTimeStart" and "defaultTimeEnd" or "visibleTimeStart" and "visibleTimeEnd" to initialize the Timeline');i=this.props.visibleTimeStart,s=this.props.visibleTimeEnd}const[r,a]=Se(i,s);this.state={width:1e3,visibleTimeStart:i,visibleTimeEnd:s,canvasTimeStart:r,canvasTimeEnd:a,selectedItem:null,dragTime:null,dragGroupTitle:null,resizeTime:null,resizingItem:null,resizingEdge:null};const l=Te(this.state.width),{dimensionItems:h,height:d,groupHeights:c,groupTops:p}=ye(t.items,t.groups,l,this.state.canvasTimeStart,this.state.canvasTimeEnd,t.keys,t.lineHeight,t.itemHeightRatio,t.stackItems,this.state.draggingItem,this.state.resizingItem,this.state.dragTime,this.state.resizingEdge,this.state.resizeTime,this.state.newGroupOrder);this.state.dimensionItems=h,this.state.height=d,this.state.groupHeights=c,this.state.groupTops=p}componentDidMount(){var e;this.resize(this.props),this.props.resizeDetector&&this.props.resizeDetector.addListener&&this.props.resizeDetector.addListener(this),(e=this)._resizeEventListener={handleEvent:()=>{e.resize()}},window.addEventListener("resize",e._resizeEventListener),this.lastTouchDistance=null}componentWillUnmount(){this.props.resizeDetector&&this.props.resizeDetector.addListener&&this.props.resizeDetector.removeListener(this),window.removeEventListener("resize",this._resizeEventListener)}static getDerivedStateFromProps(e,t){const{visibleTimeStart:i,visibleTimeEnd:s,items:r,groups:n}=e;let o={items:r,groups:n};const a=r!==t.items||n!==t.groups;if(i&&s)Object.assign(o,Re(i,s,a,r,n,e,t));else if(a){const i=Te(t.width);Object.assign(o,ye(r,n,i,t.canvasTimeStart,t.canvasTimeEnd,e.keys,e.lineHeight,e.itemHeightRatio,e.stackItems,t.draggingItem,t.resizingItem,t.dragTime,t.resizingEdge,t.resizeTime,t.newGroupOrder))}return o}componentDidUpdate(e,t){const i=this.state.visibleTimeEnd-this.state.visibleTimeStart,s=t.visibleTimeEnd-t.visibleTimeStart;this.props.onZoom&&i!==s&&this.props.onZoom(this.getTimelineContext(),this.getTimelineUnit()),this.props.onBoundsChange&&this.state.canvasTimeStart!==t.canvasTimeStart&&this.props.onBoundsChange(this.state.canvasTimeStart,this.state.canvasTimeStart+3*i);const r=Math.round(this.state.width*(this.state.visibleTimeStart-this.state.canvasTimeStart)/i);Math.round(t.width*(t.visibleTimeStart-t.canvasTimeStart)/s)!==r&&(this.scrollComponent.scrollLeft=r,this.scrollHeaderRef.scrollLeft=r)}columns(e,t,i,s,r,n){/*#__PURE__*/return o(_e,{canvasTimeStart:e,canvasTimeEnd:t,canvasWidth:i,lineCount:te(this.props.groups),minUnit:s,timeSteps:r,height:n,verticalLineClassNamesForTime:this.props.verticalLineClassNamesForTime})}rows(e,t,i){/*#__PURE__*/return o(Xe,{groups:i,canvasWidth:e,lineCount:te(this.props.groups),groupHeights:t,clickTolerance:this.props.clickTolerance,onRowClick:this.handleRowClick,onRowDoubleClick:this.handleRowDoubleClick,horizontalLineClassNamesForGroup:this.props.horizontalLineClassNamesForGroup,onRowContextClick:this.handleScrollContextMenu})}items(e,t,i,s,r,n,a,l){/*#__PURE__*/return o(Ne,{canvasTimeStart:e,canvasTimeEnd:i,canvasWidth:s,dimensionItems:n,groupTops:l,items:this.props.items,groups:this.props.groups,keys:this.props.keys,selectedItem:this.state.selectedItem,dragSnap:this.props.dragSnap,minResizeWidth:this.props.minResizeWidth,canChangeGroup:this.props.canChangeGroup,canMove:this.props.canMove,canResize:this.props.canResize,useResizeHandle:this.props.useResizeHandle,canSelect:this.props.canSelect,moveResizeValidator:this.props.moveResizeValidator,itemSelect:this.selectItem,itemDrag:this.dragItem,itemDrop:this.dropItem,onItemDoubleClick:this.doubleClickItem,onItemContextMenu:this.props.onItemContextMenu?this.contextMenuClickItem:void 0,itemResizing:this.resizingItem,itemResized:this.resizedItem,itemRenderer:this.props.itemRenderer,selected:this.props.selected,scrollRef:this.scrollComponent})}sidebar(e,t){const{sidebarWidth:i,handleSidebarResize:s}=this.props;return i&&/*#__PURE__*/o(Fe,{groups:this.props.groups,groupRenderer:this.props.groupRenderer,keys:this.props.keys,width:i,groupHeights:t,height:e,handleSidebarResize:s})}rightSidebar(e,t){const{rightSidebarWidth:i,handleSidebarResize:s}=this.props;return i&&/*#__PURE__*/o(Fe,{groups:this.props.groups,keys:this.props.keys,groupRenderer:this.props.groupRenderer,isRightSidebar:!0,width:i,groupHeights:t,height:e,handleSidebarResize:s})}childrenWithProps(t,i,s,r,n,o,a,l,h,d,c){if(!this.props.children)return null;const p=Array.isArray(this.props.children)?this.props.children.filter(e=>e):[this.props.children],u={canvasTimeStart:t,canvasTimeEnd:i,canvasWidth:s,visibleTimeStart:l,visibleTimeEnd:h,dimensionItems:r,items:this.props.items,groups:this.props.groups,keys:this.props.keys,groupHeights:n,groupTops:o,selected:this.getSelected(),height:a,minUnit:d,timeSteps:c};return e.Children.map(p,t=>this.isTimelineHeader(t)?null:/*#__PURE__*/e.cloneElement(t,u))}getSelected(){return this.state.selectedItem&&!this.props.selected?[this.state.selectedItem]:this.props.selected||[]}hasSelectedItem(){return Array.isArray(this.props.selected)?this.props.selected.length>0:!!this.state.selectedItem}isItemSelected(e){return this.getSelected().some(t=>t===e)}render(){const{items:e,groups:t,sidebarWidth:i,rightSidebarWidth:s,timeSteps:r,traditionalZoom:a}=this.props,{draggingItem:l,resizingItem:h,width:d,visibleTimeStart:c,visibleTimeEnd:p,canvasTimeStart:u,canvasTimeEnd:m}=this.state;let{dimensionItems:g,height:f,groupHeights:v,groupTops:b}=this.state;const y=p-c,T=Te(d),S=de(y,d,r),R=!!l||!!h;if(R){const i=ye(e,t,T,this.state.canvasTimeStart,this.state.canvasTimeEnd,this.props.keys,this.props.lineHeight,this.props.itemHeightRatio,this.props.stackItems,this.state.draggingItem,this.state.resizingItem,this.state.dragTime,this.state.resizingEdge,this.state.resizeTime,this.state.newGroupOrder);g=i.dimensionItems,f=i.height,v=i.groupHeights,b=i.groupTops}const C={height:`${f}px`};/*#__PURE__*/return o(Ue,{visibleTimeStart:c,visibleTimeEnd:p,canvasTimeStart:u,canvasTimeEnd:m,canvasWidth:T,showPeriod:this.showPeriod,timelineUnit:S,timelineWidth:this.state.width,children:/*#__PURE__*/o(at,{children:/*#__PURE__*/o(kt,{registerScroll:this.handleHeaderRef,timeSteps:r,leftSidebarWidth:this.props.sidebarWidth,rightSidebarWidth:this.props.rightSidebarWidth,children:/*#__PURE__*/n("div",{style:this.props.style,ref:e=>this.container=e,className:`react-calendar-timeline ${this.props.className}`,children:[this.renderHeaders(),/*#__PURE__*/n("div",{style:C,className:"rct-outer",children:[i>0?this.sidebar(f,v):null,/*#__PURE__*/o(Ze,{scrollRef:this.getScrollElementRef,width:d,height:f,onZoom:this.changeZoom,onWheelZoom:this.handleWheelZoom,traditionalZoom:a,onScroll:this.onScroll,isInteractingWithItem:R,children:/*#__PURE__*/n(Rt,{children:[this.columns(u,m,T,S,r,f),this.rows(T,v,t),this.items(u,y,m,T,S,g,v,b),this.childrenWithProps(u,m,T,g,v,b,f,c,p,S,r)]})}),s>0?this.rightSidebar(f,v):null]})]})})})})}}Kt.propTypes={groups:Q.oneOfType([Q.array,Q.object]).isRequired,items:Q.oneOfType([Q.array,Q.object]).isRequired,sidebarWidth:Q.number,rightSidebarWidth:Q.number,dragSnap:Q.number,minResizeWidth:Q.number,stickyHeader:Q.bool,lineHeight:Q.number,itemHeightRatio:Q.number,minZoom:Q.number,maxZoom:Q.number,clickTolerance:Q.number,canChangeGroup:Q.bool,canMove:Q.bool,canResize:Q.oneOf([!0,!1,"left","right","both"]),useResizeHandle:Q.bool,canSelect:Q.bool,stackItems:Q.bool,traditionalZoom:Q.bool,itemTouchSendsClick:Q.bool,horizontalLineClassNamesForGroup:Q.func,onItemMove:Q.func,onItemResize:Q.func,onItemClick:Q.func,onItemSelect:Q.func,onItemDeselect:Q.func,onCanvasClick:Q.func,onItemDoubleClick:Q.func,onItemContextMenu:Q.func,onCanvasDoubleClick:Q.func,onCanvasContextMenu:Q.func,onZoom:Q.func,onItemDrag:Q.func,handleSidebarResize:Q.object,moveResizeValidator:Q.func,itemRenderer:Q.func,groupRenderer:Q.func,className:Q.string,style:Q.object,keys:Q.shape({groupIdKey:Q.string,groupTitleKey:Q.string,groupLabelKey:Q.string,groupRightTitleKey:Q.string,itemIdKey:Q.string,itemTitleKey:Q.string,itemDivTitleKey:Q.string,itemGroupKey:Q.string,itemTimeStartKey:Q.string,itemTimeEndKey:Q.string}),headerRef:Q.func,scrollRef:Q.func,timeSteps:Q.shape({second:Q.number,minute:Q.number,hour:Q.number,day:Q.number,month:Q.number,year:Q.number}),defaultTimeStart:Q.object,defaultTimeEnd:Q.object,visibleTimeStart:Q.number,visibleTimeEnd:Q.number,onTimeChange:Q.func,onBoundsChange:Q.func,selected:Q.array,headerLabelFormats:Q.shape({yearShort:Q.string,yearLong:Q.string,monthShort:Q.string,monthMedium:Q.string,monthMediumLong:Q.string,monthLong:Q.string,dayShort:Q.string,dayLong:Q.string,hourShort:Q.string,hourMedium:Q.string,hourMediumLong:Q.string,hourLong:Q.string}),subHeaderLabelFormats:Q.shape({yearShort:Q.string,yearLong:Q.string,monthShort:Q.string,monthMedium:Q.string,monthLong:Q.string,dayShort:Q.string,dayMedium:Q.string,dayMediumLong:Q.string,dayLong:Q.string,hourShort:Q.string,hourLong:Q.string,minuteShort:Q.string,minuteLong:Q.string}),resizeDetector:Q.shape({addListener:Q.func,removeListener:Q.func}),verticalLineClassNamesForTime:Q.func,children:Q.node},Kt.defaultProps={sidebarWidth:150,rightSidebarWidth:0,dragSnap:6e4,minResizeWidth:20,stickyHeader:!0,lineHeight:30,itemHeightRatio:.65,minZoom:36e5,maxZoom:15778368e4,clickTolerance:3,canChangeGroup:!0,canMove:!0,canResize:"right",useResizeHandle:!1,canSelect:!0,stackItems:!1,traditionalZoom:!1,horizontalLineClassNamesForGroup:null,onItemMove:null,onItemResize:null,onItemClick:null,onItemSelect:null,onItemDeselect:null,onItemDrag:null,onCanvasClick:null,onItemDoubleClick:null,onItemContextMenu:null,onZoom:null,verticalLineClassNamesForTime:null,moveResizeValidator:null,dayBackground:null,defaultTimeStart:null,defaultTimeEnd:null,itemTouchSendsClick:!1,style:{},className:"",keys:{groupIdKey:"id",groupTitleKey:"title",groupRightTitleKey:"rightTitle",groupLabelKey:"title",itemIdKey:"id",itemTitleKey:"title",itemDivTitleKey:"title",itemGroupKey:"group",itemTimeStartKey:"start_time",itemTimeEndKey:"end_time"},timeSteps:{second:1,minute:1,hour:1,day:1,month:1,year:1},headerRef:()=>{},scrollRef:()=>{},visibleTimeStart:null,visibleTimeEnd:null,onTimeChange:function(e,t,i){i(e,t)},onBoundsChange:null,children:null,headerLabelFormats:{yearShort:"YY",yearLong:"YYYY",monthShort:"MM/YY",monthMedium:"MM/YYYY",monthMediumLong:"MMM YYYY",monthLong:"MMMM YYYY",dayShort:"L",dayLong:"dddd, LL",hourShort:"HH",hourMedium:"HH:00",hourMediumLong:"L, HH:00",hourLong:"dddd, LL, HH:00",time:"LLL"},subHeaderLabelFormats:{yearShort:"YY",yearLong:"YYYY",monthShort:"MM",monthMedium:"MMM",monthLong:"MMMM",dayShort:"D",dayMedium:"dd D",dayMediumLong:"ddd, Do",dayLong:"dddd, Do",hourShort:"HH",hourLong:"HH:00",minuteShort:"mm",minuteLong:"HH:mm"},selected:null},Kt.childContextTypes={getTimelineContext:Q.func};class Ut extends e.Component{componentDidMount(){const{unsubscribe:e,getMarker:t}=this.props.subscribeMarker({type:"Today",renderer:this.props.children,interval:this.props.interval});this.unsubscribe=e,this.getMarker=t}componentWillUnmount(){null!=this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}componentDidUpdate(e){if(e.interval!==this.props.interval&&this.getMarker){const e=this.getMarker();this.props.updateMarker(h({},e,{interval:this.props.interval}))}}render(){return null}}Ut.propTypes={subscribeMarker:Q.func.isRequired,updateMarker:Q.func.isRequired,interval:Q.number,children:Q.func},Ut.defaultProps={interval:1e4};const Gt=e=>/*#__PURE__*/o(lt,{children:({subscribeMarker:t,updateMarker:i})=>/*#__PURE__*/o(Ut,h({subscribeMarker:t,updateMarker:i},e))});Gt.displayName="TodayMarkerWrapper";class Yt extends e.Component{componentDidUpdate(e){if(e.date!==this.props.date&&this.getMarker){const e=this.getMarker();this.props.updateMarker(h({},e,{date:this.props.date}))}}componentDidMount(){const{unsubscribe:e,getMarker:t}=this.props.subscribeMarker({type:"Custom",renderer:this.props.children,date:this.props.date});this.unsubscribe=e,this.getMarker=t}componentWillUnmount(){null!=this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}render(){return null}}Yt.propTypes={subscribeMarker:Q.func.isRequired,updateMarker:Q.func.isRequired,children:Q.func,date:Q.number.isRequired};const At=e=>/*#__PURE__*/o(lt,{children:({subscribeMarker:t,updateMarker:i})=>/*#__PURE__*/o(Yt,h({subscribeMarker:t,updateMarker:i},e))});At.displayName="CustomMarkerWrapper",class extends e.Component{componentDidMount(){const{unsubscribe:e}=this.props.subscribeMarker({type:"Cursor",renderer:this.props.children});this.unsubscribe=e}componentWillUnmount(){null!=this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}render(){return null}}.propTypes={subscribeMarker:Q.func.isRequired,children:Q.func};const _t=({item:e,group:t})=>{let s=i(e.start,"x"),r=i(e.end,"x");/*#__PURE__*/return o("div",{className:"popup",children:/*#__PURE__*/n("div",{className:"popup-body",children:[/*#__PURE__*/o("h3",{children:e.title}),/*#__PURE__*/n("div",{className:"item-group",children:[/*#__PURE__*/o("span",{style:{fontWeight:"bold"},children:"Group:"})," ",t.title]}),/*#__PURE__*/n("div",{className:"dates",children:[/*#__PURE__*/o("h4",{children:"Date"}),/*#__PURE__*/n("span",{className:"date date-from",children:["From: ",s.format("LLL")]}),/*#__PURE__*/o("br",{}),/*#__PURE__*/n("span",{className:"date date-to",children:["To: ",r.format("LLL")]})]})]})})},Bt={groupIdKey:"id",groupTitleKey:"title",groupRightTitleKey:"rightTitle",itemIdKey:"id",itemTitleKey:"title",itemDivTitleKey:"title",itemGroupKey:"group",itemTimeStartKey:"start",itemTimeEndKey:"end",groupLabelKey:"title"};class Vt extends t{constructor(t){super(t),this.getTaskBackground=e=>{if(!e["task-type"])return"#2196F3";switch(e["task-type"]["task-category"]){case"scheduled_wo":return"#aa0000";case"task_card":return"#00aa00";case"maintenance_wo":return"#0000aa";default:return"#2196F3"}},this.buildData=(e,t,s,r,n,o)=>{if(e&&Array.isArray(e))for(const a of e){const e=a.resource.id+" - "+a.resource.type;t.has(e)||t.set(e,{id:t.size,title:a.resource?a.resource.title:"",hasChildren:a.planParts&&a.planParts.length>0,parent:n,open:r<1,show:r<2,level:r});const l=i("SessionPlan"===a.type?a["start-time"]:a["planned-start-time"]).add("1","year").add("2","month").add("27","day"),h=i("SessionPlan"===a.type?a["end-time"]:a["planned-end-time"]).add("1","year").add("2","month").add("27","day"),d=s.length+1;s.push({id:d,group:t.get(e).id,title:a.title,start:l,end:h,parent:o,className:"item",bgColor:this.getTaskBackground(a),color:"#fff",selectedBgColor:"#FFC107",selectedColor:"#000",draggingBgColor:"#f00",highlightBgColor:"#FFA500",highlight:!1,canMove:r>1&&3!==r,canResize:"both",minimumDuration:!1}),a.planParts&&a.planParts.length>0&&this.buildData(a.planParts,t,s,r+1,t.get(e).id,d)}},this.handleItemMove=(e,t,s)=>{const{items:r,groups:n}=this.state,o=n.filter(e=>e.show)[s];this.addUndoItem(r.find(t=>t.id===e)),this.setState({items:r.map(s=>s.id===e?Object.assign({},s,{start:i(t),end:i(t+(s.end-s.start)),group:o.id}):s),draggedItem:void 0})},this.handleItemResize=(e,t,s)=>{const{items:r}=this.state,n=r.find(t=>t.id===e);this.addUndoItem(n);let o=i("left"===s?t:n.start),a=i("left"===s?n.end:t);this.isLessThanMinimumDuration(n,o,a)?"left"===s?o=a.clone().subtract(n.minimumDuration,"minute"):a=o.clone().add(n.minimumDuration,"minute"):this.isMoreThanMaximumDuration(n,o,a)&&("left"===s?o=a.clone().subtract(n.maximumDuration,"minute"):a=o.clone().add(n.maximumDuration,"minute")),n.start=o,n.end=a,this.setState({items:r,draggedItem:void 0})},this.handleItemDrag=({eventType:e,itemId:t,time:s,edge:r,newGroupOrder:n})=>{let o=this.state.draggedItem?this.state.draggedItem.item:void 0;if(o||(o=this.state.items.find(e=>e.id===t)),"resize"===e){let e=o.start,t=o.end;"left"===r?e=i(s):t=i(s),this.isLessThanMinimumDuration(o,e,t)&&(s="left"===r?t.clone().subtract(o.minimumDuration,"minute"):e.clone().add(o.minimumDuration,"minute"))}const a=this.state.groups.filter(e=>e.show)[n];this.setState({draggedItem:{item:o,group:a,time:s}}),this.showItemInfo(o,a,{type:e,side:r,time:s})},this.isLessThanMinimumDuration=(e,t,s)=>!!e.minimumDuration&&i.duration(s.diff(t)).asMinutes()<e.minimumDuration,this.isMoreThanMaximumDuration=(e,t,s)=>!!e.maximumDuration&&i.duration(s.diff(t)).asMinutes()>e.maximumDuration,this.toggleGroup=e=>{let{groups:t}=this.state;const i=t.find(t=>t.id===e);i.open=!i.open,t.filter(t=>t.parent===e).forEach(e=>{e.show=i.open,i.open||(e.open=!1,t=this.closeChildren(t,e.id))}),this.setState({groups:t})},this.closeChildren=(e,t)=>(e.filter(e=>e.parent===t).forEach(t=>{t.show=!1,t.hasChildren&&(t.open=!1,e=this.closeChildren(e,t.id))}),e),this.highlightChildren=e=>{const t=this.state.items.filter(t=>t.parent===e.id);for(const e of t)e.highlight=!0,this.highlightChildren(e)},this.removeHighlight=()=>{const e=this.state.items.filter(e=>e.highlight);for(const t of e)t.highlight=!1},this.itemDeselected=()=>{this.removeHighlight(),this.setState({items:this.state.items,popup:{open:!1}})},this.showItemInfo=(e,t,i)=>{if(!e)return;let s=e.start,r=e.end;i&&("resize"===i.type?"left"===i.side?s=i.time:r=i.time:"move"===i.type&&(r=i.time+(e.end-e.start),s=i.time)),this.setState({popup:{open:!0,item:h({},e,{start:s,end:r}),group:null!=t?t:this.state.groups.find(t=>t.id===e.group),custom:this.state.popup.custom}})},this.onSidebarDown=e=>{0===e.button&&(e.stopPropagation(),e.preventDefault(),this.setState({sidebarWidth:e.clientX-document.querySelector(".rct-sidebar").getBoundingClientRect().left,sidebarResizing:!0}))},this.onSidebarMove=e=>{if(e.stopPropagation(),e.preventDefault(),!this.state.sidebarResizing)return;const t=e.clientX-document.querySelector(".rct-sidebar").getBoundingClientRect().left;t<10||this.setState({sidebarWidth:t})},this.onSidebarUp=e=>{e.stopPropagation(),e.preventDefault(),this.setState({sidebarResizing:!1})},this.addUndoItem=e=>{this.redoActions=[],this.actions.push(Object.assign({},e))},this.undo=()=>{if(this.actions.length<=0)return;const{items:e}=this.state,t=this.actions.pop();this.redoActions.push(e.find(e=>e.id===t.id)),this.setState({items:e.map(e=>e.id===t.id?Object.assign({},t):e),draggedItem:void 0})},this.redo=()=>{if(this.redoActions.length<=0)return;const{items:e}=this.state,t=this.redoActions.pop();this.actions.push(e.find(e=>e.id===t.id)),this.setState({items:e.map(e=>e.id===t.id?Object.assign({},t):e),draggedItem:void 0})},this.focusItems=e=>{if(!e||!Array.isArray(e)||e.length<=0)return;this.removeHighlight();let t=e[0].start.clone(),i=e[0].end.clone();e[0].highlight=!0,e.shift();for(const s of e)t.diff(s.start)>0&&(t=s.start.clone()),i.diff(s.end)<0&&(i=s.end.clone()),s.highlight=!0;t.subtract(1,"hour"),i.add(2,"hour"),this.timeline.current.updateScrollCanvas(t.valueOf(),i.valueOf())},this.itemRenderer=({item:e,itemContext:t,getItemProps:i,getResizeProps:s})=>{const{left:r,right:a}=s();let d=e.bgColor,c=e.color;return t.selected?(c=e.selectedColor,d=t.dragging?e.draggingBgColor:e.selectedBgColor):e.highlight&&(d=e.highlightBgColor),t.dimensions.width<20&&(t.dimensions.width=20),/*#__PURE__*/n("div",h({},i({style:{background:d,color:c,minWidth:20},onMouseDown:()=>{e.selected=!0,this.removeHighlight(),this.highlightChildren(e),this.showItemInfo(this.state.items.find(t=>t.id===e.id)),this.setState({items:this.state.items})}}),{id:"item-"+e.id,className:e.canMove?"movable-item":"static-item",children:[!t.selected||"both"!==e.canResize&&"left"!==e.canResize?"":t.useResizeHandle?/*#__PURE__*/o("div",h({},r)):/*#__PURE__*/o("span",{style:{cursor:"ew-resize",width:3,zIndex:1e3,position:"absolute",top:0,left:-3,height:"100%"}}),/*#__PURE__*/o("div",{style:{height:t.dimensions.height,overflow:"hidden",paddingLeft:3,textOverflow:"ellipsis",whiteSpace:"nowrap",zIndex:"100",position:"relative"},children:t.title}),e.dependency?/*#__PURE__*/o(l,{start:"item-"+e.dependency,end:"item-"+e.id,strokeWidth:2,headSize:6}):"",!t.selected||"both"!==e.canResize&&"right"!==e.canResize?"":t.useResizeHandle?/*#__PURE__*/o("div",h({},a)):/*#__PURE__*/o("span",{style:{cursor:"ew-resize",width:3,zIndex:1e3,position:"absolute",top:0,right:-3,height:"100%"}})]}))},this.actions=[],this.redoActions=[];let s=t.items||[],r=t.groups||[];Array.isArray(s)||(s=[]),Array.isArray(r)||(r=[]);for(const e of s)e.parent=null!=e.parent?e.parent:null,e.className=null!=e.className?e.className:"item",e.bgColor=null!=e.bgColor?e.bgColor:"#2196F3",e.color=null!=e.color?e.color:"#fff",e.selectedBgColor=null!=e.selectedBgColor?e.selectedBgColor:"#FFC107",e.selectedColor=null!=e.selectedColor?e.selectedColor:"#000",e.draggingBgColor=null!=e.draggingBgColor?e.draggingBgColor:"#f00",e.highlightBgColor=null!=e.highlightBgColor?e.highlightBgColor:"#FFA500",e.highlight=null!=e.highlight&&e.highlight,e.canMove=null==e.canMove||e.canMove,e.canResize=null!=e.canResize?e.canResize:"both",e.minimumDuration=null!=e.minimumDuration&&e.minimumDuration,e.maximumDuration=null!=e.maximumDuration&&e.maximumDuration;r=r.sort((e,t)=>e.level-t.level).reduce((e,t)=>{let i=e.find(e=>e.id===t.parent),s=e.indexOf(i);const r=e.filter(e=>e.parent===t.parent).length;return s=-1!==s?s+r+1:e.length,e.splice(s,0,t),e},[]);const a=s.length>0?i(s[0].start).add(-12,"hour"):i(),d=a.clone().add(7,"day"),c={open:!1,item:null,custom:null!=t.popup&&t.popup};let p=[];t.milestones&&(p=t.milestones),this.timeline=/*#__PURE__*/e.createRef(),this.state={groups:r,items:s,defaultTimeStart:a,defaultTimeEnd:d,sidebarWidth:250,sidebarResizing:!1,popup:c,milestones:p}}onTimeChange(e,t,i,s){i(e,t)}render(){const{groups:e,items:t,defaultTimeStart:i,defaultTimeEnd:s,sidebarWidth:r,popup:a,milestones:l}=this.state,d=e.filter(e=>e.show).map(e=>Object.assign({},e,{title:e.hasChildren?/*#__PURE__*/n("div",{onClick:()=>this.toggleGroup(e.id),style:{cursor:"pointer",paddingLeft:20*e.level},children:[e.open?"[-]":"[+]"," ",e.title]}):/*#__PURE__*/o("div",{style:{paddingLeft:20*e.level},children:e.title})}));/*#__PURE__*/return n("div",{children:[/*#__PURE__*/n(Kt,{ref:this.timeline,groups:d,items:t,keys:Bt,fullUpdate:!0,itemTouchSendsClick:!1,stackItems:!0,itemHeightRatio:.75,canMove:!0,canResize:"both",sidebarWidth:r,defaultTimeStart:i,defaultTimeEnd:s,onTimeChange:this.onTimeChange,itemRenderer:this.itemRenderer,onItemMove:this.handleItemMove,onItemResize:this.handleItemResize,onItemDeselect:this.itemDeselected,onItemDrag:this.handleItemDrag,handleSidebarResize:{down:this.onSidebarDown,move:this.onSidebarMove,up:this.onSidebarUp,resizing:this.state.sidebarResizing},children:[/*#__PURE__*/o(Gt,{interval:1e3}),l.length>0?l.map((e,t)=>/*#__PURE__*/o(At,{date:e.date.valueOf(),children:({styles:t})=>{const i=h({},t,{backgroundColor:e.color?e.color:"#000",width:"3px",pointerEvents:"auto",zIndex:1e3});/*#__PURE__*/return o("div",{style:i,className:"milestone",children:/*#__PURE__*/n("span",{className:"milestone-label",children:[e.label?e.label:"",/*#__PURE__*/o("br",{}),/*#__PURE__*/o("span",{className:"milestone-date",children:e.date.format("LLL")})]})})}},"marker-"+t)):""]}),/*#__PURE__*/n("div",{className:"action-buttons",children:[/*#__PURE__*/o("button",{className:"action-button "+(this.actions.length<=0?"disabled":""),onClick:this.undo,children:"Undo"}),/*#__PURE__*/o("button",{className:"action-button "+(this.redoActions.length<=0?"disabled":""),onClick:this.redo,children:"Redo"})]}),a.open&&(a.custom?a.custom({item:a.item,group:a.group}):/*#__PURE__*/o(_t,{item:a.item,group:a.group})),/*#__PURE__*/n("div",{className:"explanatory-notes",children:[/*#__PURE__*/o("h3",{children:"Task types"}),/*#__PURE__*/n("div",{className:"note",children:[/*#__PURE__*/o("span",{className:"color scheduled-wo"}),"Scheduled_wo"]}),/*#__PURE__*/n("div",{className:"note",children:[/*#__PURE__*/o("span",{className:"color task-card"}),"Task_card"]}),/*#__PURE__*/n("div",{className:"note",children:[/*#__PURE__*/o("span",{className:"color maintenance-wo"}),"Maintenance_wo"]})]})]})}}Vt.propTypes={items:Q.arrayOf(Q.shape({id:Q.number.isRequired,group:Q.number.isRequired,title:Q.string,start:Q.instanceOf(i).isRequired,end:Q.instanceOf(i).isRequired,parent:Q.number,className:Q.string,bgColor:Q.string,color:Q.string,selectedBgColor:Q.string,selectedColor:Q.string,draggingBgColor:Q.string,highlightBgColor:Q.string,highlight:Q.bool,canMove:Q.bool,canResize:Q.oneOf(["both","left","right",!1]),minimumDuration:Q.oneOfType([Q.number,Q.oneOf([!1])]),maximumDuration:Q.oneOfType([Q.number,Q.oneOf([!1])])})).isRequired,groups:Q.arrayOf(Q.shape({id:Q.number.isRequired,title:Q.string.isRequired,hasChildren:Q.bool,parent:Q.number,open:Q.bool.isRequired,show:Q.bool.isRequired,level:Q.number.isRequired})).isRequired,popup:Q.elementType,milestones:Q.arrayOf(Q.shape({date:Q.instanceOf(i).isRequired,label:Q.string,color:Q.string}))},Vt.defaultProps={items:[{parent:null,className:"item",bgColor:"#2196F3",color:"#fff",selectedBgColor:"#FFC107",selectedColor:"#000",draggingBgColor:"#f00",highlightBgColor:"#FFA500",highlight:!1,canMove:!0,canResize:"both",minimumDuration:!1,maximumDuration:!1}],groups:[],popup:_t};export{Vt as default};
//# sourceMappingURL=PlanningTool.modern.js.map
