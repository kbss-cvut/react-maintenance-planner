var e=require("react"),t=require("moment"),i=require("react-icons/hi"),n=require("react-icons/fa"),o=require("@kbss-cvut/react-calendar-timeline");require("@kbss-cvut/react-calendar-timeline/lib/Timeline.css");var s=require("react-xarrows"),r=require("react/jsx-runtime"),a=require("react-calendar-datetime-picker");require("react-calendar-datetime-picker/dist/index.css");var l=require("react-dropdown-tree-select");require("react-dropdown-tree-select/dist/styles.css");var d=require("@tippyjs/react");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u=/*#__PURE__*/c(e),h=/*#__PURE__*/c(t),m=/*#__PURE__*/c(o),p=/*#__PURE__*/c(s),f=/*#__PURE__*/c(a),g=/*#__PURE__*/c(l),y=/*#__PURE__*/c(d);function b(e){var t={exports:{}};return e(t,t.exports),t.exports}var v="function"==typeof Symbol&&Symbol.for,E=v?Symbol.for("react.element"):60103,I=v?Symbol.for("react.portal"):60106,R=v?Symbol.for("react.fragment"):60107,S=v?Symbol.for("react.strict_mode"):60108,x=v?Symbol.for("react.profiler"):60114,C=v?Symbol.for("react.provider"):60109,O=v?Symbol.for("react.context"):60110,D=v?Symbol.for("react.async_mode"):60111,M=v?Symbol.for("react.concurrent_mode"):60111,T=v?Symbol.for("react.forward_ref"):60112,j=v?Symbol.for("react.suspense"):60113,N=v?Symbol.for("react.suspense_list"):60120,w=v?Symbol.for("react.memo"):60115,k=v?Symbol.for("react.lazy"):60116,_=v?Symbol.for("react.block"):60121,A=v?Symbol.for("react.fundamental"):60117,P=v?Symbol.for("react.responder"):60118,U=v?Symbol.for("react.scope"):60119;function $(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case E:switch(e=e.type){case D:case M:case R:case x:case S:case j:return e;default:switch(e=e&&e.$$typeof){case O:case T:case k:case w:case C:return e;default:return t}}case I:return t}}}function z(e){return $(e)===M}var L={AsyncMode:D,ConcurrentMode:M,ContextConsumer:O,ContextProvider:C,Element:E,ForwardRef:T,Fragment:R,Lazy:k,Memo:w,Portal:I,Profiler:x,StrictMode:S,Suspense:j,isAsyncMode:function(e){return z(e)||$(e)===D},isConcurrentMode:z,isContextConsumer:function(e){return $(e)===O},isContextProvider:function(e){return $(e)===C},isElement:function(e){return"object"==typeof e&&null!==e&&e.$$typeof===E},isForwardRef:function(e){return $(e)===T},isFragment:function(e){return $(e)===R},isLazy:function(e){return $(e)===k},isMemo:function(e){return $(e)===w},isPortal:function(e){return $(e)===I},isProfiler:function(e){return $(e)===x},isStrictMode:function(e){return $(e)===S},isSuspense:function(e){return $(e)===j},isValidElementType:function(e){return"string"==typeof e||"function"==typeof e||e===R||e===M||e===x||e===S||e===j||e===N||"object"==typeof e&&null!==e&&(e.$$typeof===k||e.$$typeof===w||e.$$typeof===C||e.$$typeof===O||e.$$typeof===T||e.$$typeof===A||e.$$typeof===P||e.$$typeof===U||e.$$typeof===_)},typeOf:$},F=b(function(e,t){"production"!==process.env.NODE_ENV&&function(){var e="function"==typeof Symbol&&Symbol.for,i=e?Symbol.for("react.element"):60103,n=e?Symbol.for("react.portal"):60106,o=e?Symbol.for("react.fragment"):60107,s=e?Symbol.for("react.strict_mode"):60108,r=e?Symbol.for("react.profiler"):60114,a=e?Symbol.for("react.provider"):60109,l=e?Symbol.for("react.context"):60110,d=e?Symbol.for("react.async_mode"):60111,c=e?Symbol.for("react.concurrent_mode"):60111,u=e?Symbol.for("react.forward_ref"):60112,h=e?Symbol.for("react.suspense"):60113,m=e?Symbol.for("react.suspense_list"):60120,p=e?Symbol.for("react.memo"):60115,f=e?Symbol.for("react.lazy"):60116,g=e?Symbol.for("react.block"):60121,y=e?Symbol.for("react.fundamental"):60117,b=e?Symbol.for("react.responder"):60118,v=e?Symbol.for("react.scope"):60119;function E(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:var m=e.type;switch(m){case d:case c:case o:case r:case s:case h:return m;default:var g=m&&m.$$typeof;switch(g){case l:case u:case f:case p:case a:return g;default:return t}}case n:return t}}}var I=c,R=l,S=a,x=i,C=u,O=o,D=f,M=p,T=n,j=r,N=s,w=h,k=!1;function _(e){return E(e)===c}t.AsyncMode=d,t.ConcurrentMode=I,t.ContextConsumer=R,t.ContextProvider=S,t.Element=x,t.ForwardRef=C,t.Fragment=O,t.Lazy=D,t.Memo=M,t.Portal=T,t.Profiler=j,t.StrictMode=N,t.Suspense=w,t.isAsyncMode=function(e){return k||(k=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),_(e)||E(e)===d},t.isConcurrentMode=_,t.isContextConsumer=function(e){return E(e)===l},t.isContextProvider=function(e){return E(e)===a},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===i},t.isForwardRef=function(e){return E(e)===u},t.isFragment=function(e){return E(e)===o},t.isLazy=function(e){return E(e)===f},t.isMemo=function(e){return E(e)===p},t.isPortal=function(e){return E(e)===n},t.isProfiler=function(e){return E(e)===r},t.isStrictMode=function(e){return E(e)===s},t.isSuspense=function(e){return E(e)===h},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===c||e===r||e===s||e===h||e===m||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===p||e.$$typeof===a||e.$$typeof===l||e.$$typeof===u||e.$$typeof===y||e.$$typeof===b||e.$$typeof===v||e.$$typeof===g)},t.typeOf=E}()}),G=b(function(e){e.exports="production"===process.env.NODE_ENV?L:F}),q=Object.getOwnPropertySymbols,V=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,B=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;var n=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==n.join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(e){o[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var i,n,o=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),s=1;s<arguments.length;s++){for(var r in i=Object(arguments[s]))V.call(i,r)&&(o[r]=i[r]);if(q){n=q(i);for(var a=0;a<n.length;a++)W.call(i,n[a])&&(o[n[a]]=i[n[a]])}}return o},K=Function.call.bind(Object.prototype.hasOwnProperty),H="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Y=K,J=function(){};if("production"!==process.env.NODE_ENV){var Z=H,X={},Q=Y;J=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}}}function ee(e,t,i,n,o){if("production"!==process.env.NODE_ENV)for(var s in e)if(Q(e,s)){var r;try{if("function"!=typeof e[s]){var a=Error((n||"React class")+": "+i+" type `"+s+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[s]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw a.name="Invariant Violation",a}r=e[s](t,s,n,i,null,Z)}catch(e){r=e}if(!r||r instanceof Error||J((n||"React class")+": type specification of "+i+" `"+s+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof r+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),r instanceof Error&&!(r.message in X)){X[r.message]=!0;var l=o?o():"";J("Failed "+i+" type: "+r.message+(null!=l?l:""))}}}ee.resetWarningCache=function(){"production"!==process.env.NODE_ENV&&(X={})};var te=ee,ie=function(){};function ne(){return null}function oe(){}function se(){}"production"!==process.env.NODE_ENV&&(ie=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}}),se.resetWarningCache=oe;var re=b(function(e){e.exports="production"!==process.env.NODE_ENV?function(e,t){var i="function"==typeof Symbol&&Symbol.iterator,n="<<anonymous>>",o={array:l("array"),bigint:l("bigint"),bool:l("boolean"),func:l("function"),number:l("number"),object:l("object"),string:l("string"),symbol:l("symbol"),any:a(ne),arrayOf:function(e){return a(function(t,i,n,o,s){if("function"!=typeof e)return new r("Property `"+s+"` of component `"+n+"` has invalid PropType notation inside arrayOf.");var a=t[i];if(!Array.isArray(a))return new r("Invalid "+o+" `"+s+"` of type `"+u(a)+"` supplied to `"+n+"`, expected an array.");for(var l=0;l<a.length;l++){var d=e(a,l,n,o,s+"["+l+"]",H);if(d instanceof Error)return d}return null})},element:a(function(t,i,n,o,s){var a=t[i];return e(a)?null:new r("Invalid "+o+" `"+s+"` of type `"+u(a)+"` supplied to `"+n+"`, expected a single ReactElement.")}),elementType:a(function(e,t,i,n,o){var s=e[t];return G.isValidElementType(s)?null:new r("Invalid "+n+" `"+o+"` of type `"+u(s)+"` supplied to `"+i+"`, expected a single ReactElement type.")}),instanceOf:function(e){return a(function(t,i,o,s,a){return t[i]instanceof e?null:new r("Invalid "+s+" `"+a+"` of type `"+((l=t[i]).constructor&&l.constructor.name?l.constructor.name:n)+"` supplied to `"+o+"`, expected instance of `"+(e.name||n)+"`.");var l})},node:a(function(e,t,i,n,o){return c(e[t])?null:new r("Invalid "+n+" `"+o+"` supplied to `"+i+"`, expected a ReactNode.")}),objectOf:function(e){return a(function(t,i,n,o,s){if("function"!=typeof e)return new r("Property `"+s+"` of component `"+n+"` has invalid PropType notation inside objectOf.");var a=t[i],l=u(a);if("object"!==l)return new r("Invalid "+o+" `"+s+"` of type `"+l+"` supplied to `"+n+"`, expected an object.");for(var d in a)if(Y(a,d)){var c=e(a,d,n,o,s+"."+d,H);if(c instanceof Error)return c}return null})},oneOf:function(e){return Array.isArray(e)?a(function(t,i,n,o,a){for(var l=t[i],d=0;d<e.length;d++)if(s(l,e[d]))return null;var c=JSON.stringify(e,function(e,t){return"symbol"===h(t)?String(t):t});return new r("Invalid "+o+" `"+a+"` of value `"+String(l)+"` supplied to `"+n+"`, expected one of "+c+".")}):("production"!==process.env.NODE_ENV&&ie(arguments.length>1?"Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).":"Invalid argument supplied to oneOf, expected an array."),ne)},oneOfType:function(e){if(!Array.isArray(e))return"production"!==process.env.NODE_ENV&&ie("Invalid argument supplied to oneOfType, expected an instance of array."),ne;for(var t=0;t<e.length;t++){var i=e[t];if("function"!=typeof i)return ie("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+m(i)+" at index "+t+"."),ne}return a(function(t,i,n,o,s){for(var a=[],l=0;l<e.length;l++){var d=(0,e[l])(t,i,n,o,s,H);if(null==d)return null;d.data&&Y(d.data,"expectedType")&&a.push(d.data.expectedType)}return new r("Invalid "+o+" `"+s+"` supplied to `"+n+"`"+(a.length>0?", expected one of type ["+a.join(", ")+"]":"")+".")})},shape:function(e){return a(function(t,i,n,o,s){var a=t[i],l=u(a);if("object"!==l)return new r("Invalid "+o+" `"+s+"` of type `"+l+"` supplied to `"+n+"`, expected `object`.");for(var c in e){var m=e[c];if("function"!=typeof m)return d(n,o,s,c,h(m));var p=m(a,c,n,o,s+"."+c,H);if(p)return p}return null})},exact:function(e){return a(function(t,i,n,o,s){var a=t[i],l=u(a);if("object"!==l)return new r("Invalid "+o+" `"+s+"` of type `"+l+"` supplied to `"+n+"`, expected `object`.");var c=B({},t[i],e);for(var m in c){var p=e[m];if(Y(e,m)&&"function"!=typeof p)return d(n,o,s,m,h(p));if(!p)return new r("Invalid "+o+" `"+s+"` key `"+m+"` supplied to `"+n+"`.\nBad object: "+JSON.stringify(t[i],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var f=p(a,m,n,o,s+"."+m,H);if(f)return f}return null})}};function s(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function r(e,t){this.message=e,this.data=t&&"object"==typeof t?t:{},this.stack=""}function a(e){if("production"!==process.env.NODE_ENV)var i={},o=0;function s(s,a,l,d,c,u,h){if(d=d||n,u=u||l,h!==H){if(t){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}if("production"!==process.env.NODE_ENV&&"undefined"!=typeof console){var p=d+":"+l;!i[p]&&o<3&&(ie("You are manually calling a React.PropTypes validation function for the `"+u+"` prop on `"+d+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),i[p]=!0,o++)}}return null==a[l]?s?new r(null===a[l]?"The "+c+" `"+u+"` is marked as required in `"+d+"`, but its value is `null`.":"The "+c+" `"+u+"` is marked as required in `"+d+"`, but its value is `undefined`."):null:e(a,l,d,c,u)}var a=s.bind(null,!1);return a.isRequired=s.bind(null,!0),a}function l(e){return a(function(t,i,n,o,s,a){var l=t[i];return u(l)!==e?new r("Invalid "+o+" `"+s+"` of type `"+h(l)+"` supplied to `"+n+"`, expected `"+e+"`.",{expectedType:e}):null})}function d(e,t,i,n,o){return new r((e||"React class")+": "+t+" type `"+i+"."+n+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+o+"`.")}function c(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(c);if(null===t||e(t))return!0;var n=function(e){var t=e&&(i&&e[i]||e["@@iterator"]);if("function"==typeof t)return t}(t);if(!n)return!1;var o,s=n.call(t);if(n!==t.entries){for(;!(o=s.next()).done;)if(!c(o.value))return!1}else for(;!(o=s.next()).done;){var r=o.value;if(r&&!c(r[1]))return!1}return!0;default:return!1}}function u(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||!!t&&("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}(t,e)?"symbol":t}function h(e){if(null==e)return""+e;var t=u(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function m(e){var t=h(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return r.prototype=Error.prototype,o.checkPropTypes=te,o.resetWarningCache=te.resetWarningCache,o.PropTypes=o,o}(G.isElement,!0):function(){function e(e,t,i,n,o,s){if(s!==H){var r=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw r.name="Invariant Violation",r}}function t(){return e}e.isRequired=e;var i={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:se,resetWarningCache:oe};return i.PropTypes=i,i}()});const ae=({item:e})=>/*#__PURE__*/r.jsx("p",{children:e.title});class le extends u.default.Component{constructor(...e){super(...e),this.onSubmit=()=>{this.props.onSubmit()},this.onDelete=()=>{this.props.onDelete()}}render(){/*#__PURE__*/return r.jsxs("div",{className:"modal",children:[/*#__PURE__*/r.jsxs("div",{className:"modal-header",children:[/*#__PURE__*/r.jsx("span",{className:"modal-title",children:this.props.title}),/*#__PURE__*/r.jsx("span",{className:"modal-close",onClick:this.props.onClose,children:/*#__PURE__*/r.jsx(n.FaPlus,{})})]}),/*#__PURE__*/r.jsxs("div",{className:"modal-body",children:[this.props.children,/*#__PURE__*/r.jsxs("div",{className:"modal-buttons",children:[/*#__PURE__*/r.jsxs("button",{className:"modal-submit",onClick:this.onSubmit,children:[/*#__PURE__*/r.jsx(n.FaCheck,{})," Submit"]}),this.props.onDelete&&/*#__PURE__*/r.jsxs("button",{className:"modal-delete",onClick:this.onDelete,children:[/*#__PURE__*/r.jsx(n.FaTrash,{})," Delete"]})]})]})]})}}const de=t=>{var i,n,o,s,a,l,d;const c={title:u.default.useRef(),label:u.default.useRef()},[h,m]=e.useState(t.type),{item:p,milestone:y}=t,b={from:{year:null==p?void 0:p.start.year(),month:(null==p?void 0:p.start.month())+1,day:null==p?void 0:p.start.date(),hour:null==p?void 0:p.start.hour(),minute:null==p?void 0:p.start.minute()},to:{year:null==p?void 0:p.end.year(),month:(null==p?void 0:p.end.month())+1,day:null==p?void 0:p.end.date(),hour:null==p?void 0:p.end.hour(),minute:null==p?void 0:p.end.minute()}},[v,E]=e.useState(null),[I,R]=e.useState(null===(i=t.item)||void 0===i?void 0:i.color),[S,x]=e.useState(null===(n=t.item)||void 0===n?void 0:n.bgColor);let C=t.currentGroupId;const O={year:null==y?void 0:y.date.year(),month:(null==y?void 0:y.date.month())+1,day:null==y?void 0:y.date.date(),hour:null==y?void 0:y.date.hour(),minute:null==y?void 0:y.date.minute()},[D,M]=e.useState(O),[T,j]=e.useState(null===(o=t.milestone)||void 0===o?void 0:o.color);let N=!1;return((null===(s=t.item)||void 0===s?void 0:s.removable)||(null===(a=t.milestone)||void 0===a?void 0:a.removable))&&(N=()=>{t.onDelete(p,y,h,t.type)}),/*#__PURE__*/r.jsxs(le,{title:t.title,onClose:()=>{t.onClose()},onSubmit:()=>{var e,i;t.onSubmit(p,y,{title:null===(e=c.title.current)||void 0===e?void 0:e.value,date:v,groupId:C,color:I,bgColor:S,label:null===(i=c.label.current)||void 0===i?void 0:i.value,milestoneDate:D,milestoneColor:T},t.mode,h)},onDelete:"edit"===t.mode?N:null,children:["add"===t.mode&&/*#__PURE__*/r.jsxs("div",{className:"modal-switch",children:[/*#__PURE__*/r.jsx("div",{className:"modal-switch-button "+("item"===h?"active":""),onClick:()=>m("item"),children:"Task"}),/*#__PURE__*/r.jsx("div",{className:"modal-switch-button "+("milestone"===h?"active":""),onClick:()=>m("milestone"),children:"Milestone"})]}),"item"===h&&/*#__PURE__*/r.jsxs(r.Fragment,{children:[/*#__PURE__*/r.jsxs("label",{children:["Item title",/*#__PURE__*/r.jsx("input",{type:"text",placeholder:"Resource name",ref:c.title,defaultValue:null===(l=t.item)||void 0===l?void 0:l.title})]}),/*#__PURE__*/r.jsx("label",{children:"Start date"}),/*#__PURE__*/r.jsx(f.default,{onChange:E,initValue:b,type:"range",withTime:!0,showTimeInput:!0,autoClose:!1}),/*#__PURE__*/r.jsx("label",{children:"Select resource"}),/*#__PURE__*/r.jsx(g.default,{className:"mdl-demo",data:t.groups,onChange:(e,t)=>{C=e.value},mode:"radioSelect"}),/*#__PURE__*/r.jsxs("div",{style:{display:"flex",justifyContent:"space-evenly",gap:25},children:[/*#__PURE__*/r.jsxs("label",{children:["Text",/*#__PURE__*/r.jsx("input",{type:"color",value:I,onChange:e=>R(e.target.value)})]}),/*#__PURE__*/r.jsxs("label",{children:["Background",/*#__PURE__*/r.jsx("input",{type:"color",value:S,onChange:e=>x(e.target.value)})]})]})]}),"milestone"===h&&/*#__PURE__*/r.jsxs(r.Fragment,{children:[/*#__PURE__*/r.jsxs("label",{children:["Milestone label",/*#__PURE__*/r.jsx("input",{type:"text",placeholder:"Milestone label",ref:c.label,defaultValue:null===(d=t.milestone)||void 0===d?void 0:d.label})]}),/*#__PURE__*/r.jsx("label",{children:"Date"}),/*#__PURE__*/r.jsx(f.default,{onChange:M,initValue:O,withTime:!0,showTimeInput:!0,autoClose:!1}),/*#__PURE__*/r.jsxs("label",{children:["Milestone color",/*#__PURE__*/r.jsx("input",{type:"color",value:T,onChange:e=>j(e.target.value)})]})]})]})};class ce{}ce.ITEM_EDIT="item-edit",ce.ITEM_ADD="item-add",ce.RESOURCE_EDIT="resource-edit",ce.RESOURCE_ADD="resource-add",ce.RESOURCE_REMOVE="resource-remove",ce.RESOURCE_REORDER="resource-reorder",ce.MILESTONE_ADD="milestone-add",ce.MILESTONE_EDIT="milestone-edit",ce.ITEM_DELETE="item-delete",ce.MILESTONE_DELETE="milestone-delete",ce.DEFAULT_LEGEND_ITEMS=[{name:"Current selection & parents/children",color:"#FFC107"},{name:"Non-movable item",color:"repeating-linear-gradient( -45deg, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0) 2px, #465298 2px, #465298 4px )"}];const ue={groupIdKey:"id",groupTitleKey:"title",groupRightTitleKey:"rightTitle",itemIdKey:"id",itemTitleKey:"title",itemDivTitleKey:"title",itemGroupKey:"group",itemTimeStartKey:"start",itemTimeEndKey:"end",groupLabelKey:"title"};class he extends e.Component{constructor(e){super(e),this.setItemDefaults=e=>{e.title=null!=e.title?e.title:"",e.parent=null!=e.parent?e.parent:null,e.className=null!=e.className?e.className:"item",e.bgColor=null!=e.bgColor?e.bgColor:"#2196F3",e.color=null!=e.color?e.color:"#ffffff",e.selectedBgColor=null!=e.selectedBgColor?e.selectedBgColor:"#FFC107",e.selectedColor=null!=e.selectedColor?e.selectedColor:"#000000",e.draggingBgColor=null!=e.draggingBgColor?e.draggingBgColor:"#f00",e.highlightBgColor=null!=e.highlightBgColor?e.highlightBgColor:"#FFA555",e.highlight=null!=e.highlight&&e.highlight,e.canMove=null==e.canMove||e.canMove,e.canResize=null!=e.canResize?e.canResize:"both",e.minimumDuration=null!=e.minimumDuration&&e.minimumDuration,e.maximumDuration=null!=e.maximumDuration&&e.maximumDuration,e.removable=null==e.removable||e.removable,e.selectedGroup=!1},this.setMilestoneDefault=e=>{e.date=null!=e.date?e.date:h.default(),e.label=null!=e.label?e.label:"",e.color=null!=e.color?e.color:"#000000",e.removable=null==e.removable||e.removable},this.getEditItemModalDefaults=()=>({open:!1,item:null,milestone:null,title:"",currentGroupId:null,onSubmit:this.handleEditItemModalSubmit,onClose:this.handleEditItemModalClose,onDelete:this.handleEditItemModalDelete,mode:null,type:"item"}),this.handleItemMove=(e,t,i)=>{const{items:n,groups:o}=this.state,s=o.filter(e=>e.show)[i],r=n.find(t=>t.id===e),a=h.default(t),l=h.default(t+(r.end-r.start)),d=a.diff(r.start),c=n.filter(e=>e.selectedGroup&&e.canMove&&r.id!==e.id);this.addUndoItem(r,ce.ITEM_EDIT,{selectedItems:c,diff:d},!0);const u=n.indexOf(r);n[u]=Object.assign({},r,{start:a,end:l,group:s.id}),c.forEach(e=>{const t=n.indexOf(e);n[t]=Object.assign({},e,{start:e.start.add(d),end:e.end.add(d)})}),this.setState({items:n,draggedItem:void 0})},this.handleItemResize=(e,t,i)=>{const{items:n}=this.state,o=n.find(t=>t.id===e);this.addUndoItem(o,ce.ITEM_EDIT,{},!0);let s=h.default("left"===i?t:o.start),r=h.default("left"===i?o.end:t);this.isLessThanMinimumDuration(o,s,r)?"left"===i?s=r.clone().subtract(o.minimumDuration,"minute"):r=s.clone().add(o.minimumDuration,"minute"):this.isMoreThanMaximumDuration(o,s,r)&&("left"===i?s=r.clone().subtract(o.maximumDuration,"minute"):r=s.clone().add(o.maximumDuration,"minute")),o.start=s,o.end=r,this.setState({items:n,draggedItem:void 0})},this.handleItemDrag=({eventType:e,itemId:t,time:i,edge:n,newGroupOrder:o})=>{let s=this.state.draggedItem?this.state.draggedItem.item:void 0;if(s||(s=this.state.items.find(e=>e.id===t)),"resize"===e){let e=s.start,t=s.end;"left"===n?e=h.default(i):t=h.default(i),this.isLessThanMinimumDuration(s,e,t)&&(i="left"===n?t.clone().subtract(s.minimumDuration,"minute"):e.clone().add(s.minimumDuration,"minute"))}const r=this.state.groups.filter(e=>e.show)[o];this.setState({draggedItem:{item:s,group:r,time:i}}),this.showItemInfo(s,r,{type:e,side:n,time:i})},this.isLessThanMinimumDuration=(e,t,i)=>!!e.minimumDuration&&h.default.duration(i.diff(t)).asMinutes()<e.minimumDuration,this.isMoreThanMaximumDuration=(e,t,i)=>!!e.maximumDuration&&h.default.duration(i.diff(t)).asMinutes()>e.maximumDuration,this.toggleGroup=e=>{let{groups:t}=this.state;const i=t.find(t=>t.id===e);i.open=!i.open,t.filter(t=>t.parent===e).forEach(e=>{e.show=i.open,i.open||(e.open=!1,t=this.closeChildren(t,e.id))}),this.setState({groups:t})},this.closeChildren=(e,t)=>(e.filter(e=>e.parent===t).forEach(t=>{t.show=!1,t.hasChildren&&(t.open=!1,e=this.closeChildren(e,t.id))}),e),this.highlightChildren=e=>{const t=this.state.items.filter(t=>t.parent===e.id);for(const e of t)e.highlight=!0,this.highlightChildren(e)},this.highlightParents=e=>{if(e.parent){const t=this.state.items.find(t=>t.id===e.parent);t.highlight=!0,this.highlightParents(t)}},this.removeHighlight=()=>{const e=this.state.items.filter(e=>e.highlight);for(const t of e)t.highlight=!1},this.removeSelectedGroups=()=>{const e=this.state.items.filter(e=>e.selectedGroup);for(const t of e)t.selectedGroup=!1},this.itemDeselected=()=>{this.removeHighlight(),this.removeSelectedGroups(),this.setState({items:this.state.items,popup:{open:!1}})},this.showItemInfo=(e,t,i)=>{if(!e)return;let n=e.start,o=e.end;i&&("resize"===i.type?"left"===i.side?n=i.time:o=i.time:"move"===i.type&&(o=i.time+(e.end-e.start),n=i.time)),this.setState({popup:{open:!0,item:{...e,start:n,end:o},group:null!=t?t:this.state.groups.find(t=>t.id===e.group),custom:this.state.popup.custom}})},this.onSidebarDown=e=>{0===e.button&&(e.stopPropagation(),e.preventDefault(),this.setState({sidebarWidth:e.clientX-document.querySelector(".rct-sidebar").getBoundingClientRect().left,sidebarResizing:!0}))},this.onSidebarMove=e=>{if(e.stopPropagation(),e.preventDefault(),!this.state.sidebarResizing)return;const t=e.clientX-document.querySelector(".rct-sidebar").getBoundingClientRect().left;t<10||(this.setState({sidebarWidth:t}),this.timeline.current.resize())},this.onSidebarUp=e=>{e.stopPropagation(),e.preventDefault(),this.setState({sidebarResizing:!1})},this.addUndoItem=(e,t,i={},n=!1)=>{n&&(this.redoActions=[]),this.actions.push({item:Object.assign({},e),actionName:t,params:i})},this.addRedoItem=(e,t,i={})=>{this.redoActions.push({item:e,actionName:t,params:i})},this.undo=()=>{if(this.actions.length<=0)return;const e=this.actions.pop();e.actionName!==ce.ITEM_EDIT?e.actionName!==ce.ITEM_ADD?e.actionName!==ce.RESOURCE_EDIT?e.actionName!==ce.RESOURCE_ADD?e.actionName!==ce.RESOURCE_REMOVE?e.actionName!==ce.RESOURCE_REORDER?e.actionName!==ce.MILESTONE_ADD?e.actionName!==ce.MILESTONE_EDIT?e.actionName!==ce.ITEM_DELETE?e.actionName!==ce.MILESTONE_DELETE||this.undoMilestoneDelete(e):this.undoItemDelete(e):this.undoMilestoneEdit(e):this.undoMilestoneAdd(e):this.undoResourceReorder(e):this.undoResourceRemove(e):this.undoResourceAdd(e):this.undoResourceEdit(e):this.undoItemAdd(e):this.undoItemEdit(e)},this.undoMilestoneDelete=e=>{const{milestones:t}=this.state,i=e.item;t.splice(e.params.index,0,i),this.addRedoItem(i,ce.MILESTONE_DELETE),this.setState({milestones:t})},this.undoItemDelete=e=>{const{items:t}=this.state,i=e.item;t.splice(e.params.index,0,i),this.addRedoItem(i,ce.ITEM_DELETE),this.setState({items:t})},this.undoMilestoneAdd=e=>{const{milestones:t}=this.state,i=t.find(t=>t.id===e.item.id),n=t.indexOf(i);n<0||(this.addRedoItem(i,e.actionName),t.splice(n,1),this.setState({milestones:t}))},this.undoMilestoneEdit=e=>{const{milestones:t}=this.state,i=e.item;this.addRedoItem(t.find(e=>e.id===i.id),e.actionName),this.setState({milestones:t.map(e=>e.id===i.id?Object.assign({},i):e)})},this.undoItemAdd=e=>{const{items:t}=this.state,i=t.find(t=>t.id===e.item.id),n=t.indexOf(i);n<0||(this.addRedoItem(i,e.actionName),t.splice(n,1),this.setState({items:t}))},this.undoResourceRemove=e=>{const{groups:t}=this.state,i=e.item;this.addRedoItem(i,e.actionName);let n=e.params.index;t.splice(n,0,i);for(const i of e.params.children)t.splice(++n,0,i);t.find(e=>e.id===i.parent).hasChildren=!0,this.setState({groups:t})},this.undoResourceReorder=e=>{const{groups:t}=this.state,i=e.item,n=e.params.direction;this.addRedoItem(i,e.actionName,{direction:n}),this.handleReorderResource(null,t.find(e=>e.id===i.id),"up"===n?"down":"up",!1)},this.undoResourceAdd=e=>{const{groups:t}=this.state,i=e.item,n=t.find(e=>e.id===i.id),o=t.find(e=>e.id===n.parent),s=t.indexOf(n);s>-1&&(t.splice(s,1),this.addRedoItem(n,e.actionName,{index:s})),t.filter(e=>e.parent===o.id).length<=0&&(o.hasChildren=!1),this.setState({groups:t})},this.undoResourceEdit=e=>{const{groups:t}=this.state,i=e.item;this.addRedoItem(t.find(e=>e.id===i.id),e.actionName),this.setState({groups:t.map(e=>e.id===i.id?Object.assign({},i):e)})},this.undoItemEdit=e=>{const{items:t}=this.state,i=e.item;this.addRedoItem(t.find(e=>e.id===i.id),e.actionName,e.params),e.params.selectedItems&&e.params.diff&&e.params.selectedItems.forEach(i=>{const n=t.indexOf(t.find(e=>e.id===i.id));t[n].start=i.start.subtract(e.params.diff),t[n].end=i.end.subtract(e.params.diff)}),this.setState({items:t.map(e=>e.id===i.id?Object.assign({},i):e),draggedItem:void 0})},this.redo=()=>{if(this.redoActions.length<=0)return;const e=this.redoActions.pop();e.actionName!==ce.ITEM_EDIT?e.actionName!==ce.ITEM_ADD?e.actionName!==ce.RESOURCE_EDIT?e.actionName!==ce.RESOURCE_ADD?e.actionName!==ce.RESOURCE_REMOVE?e.actionName!==ce.RESOURCE_REORDER?e.actionName!==ce.MILESTONE_ADD?e.actionName!==ce.MILESTONE_EDIT?e.actionName!==ce.ITEM_DELETE?e.actionName!==ce.MILESTONE_DELETE||this.redoMilestoneDelete(e):this.redoItemDelete(e):this.redoMilestoneEdit(e):this.redoMilestoneAdd(e):this.redoResourceReorder(e):this.redoResourceRemove(e):this.redoResourceAdd(e):this.redoResourceEdit(e):this.redoItemAdd(e):this.redoItemEdit(e)},this.redoMilestoneDelete=e=>{const{milestones:t}=this.state,i=e.item,n=t.indexOf(i);n>-1&&(t.splice(n,1),this.addUndoItem(i,e.actionName,{index:n})),this.setState({milestones:t})},this.redoItemDelete=e=>{const{items:t}=this.state,i=e.item,n=t.indexOf(i);n>-1&&(t.splice(n,1),this.addUndoItem(i,e.actionName,{index:n})),this.setState({items:t})},this.redoMilestoneAdd=e=>{const{milestones:t}=this.state,i=e.item;this.addUndoItem(i,e.actionName),t.push(i),this.setState({milestones:t})},this.redoMilestoneEdit=e=>{const{milestones:t}=this.state,i=e.item;this.addUndoItem(t.find(e=>e.id===i.id),e.actionName),this.setState({milestones:t.map(e=>e.id===i.id?Object.assign({},i):e)})},this.redoItemEdit=e=>{const{items:t}=this.state,i=e.item;this.addUndoItem(t.find(e=>e.id===i.id),e.actionName,e.params),e.params.selectedItems&&e.params.diff&&e.params.selectedItems.forEach(i=>{const n=t.indexOf(t.find(e=>e.id===i.id));t[n].start=i.start.add(e.params.diff),t[n].end=i.end.add(e.params.diff)}),this.setState({items:t.map(e=>e.id===i.id?Object.assign({},i):e),draggedItem:void 0})},this.redoItemAdd=e=>{const{items:t}=this.state,i=e.item;this.addUndoItem(i,e.actionName),t.push(i),this.setState({items:t})},this.redoResourceEdit=e=>{const{groups:t}=this.state,i=e.item;this.addUndoItem(t.find(e=>e.id===i.id),e.actionName),this.setState({groups:t.map(e=>e.id===i.id?Object.assign({},i):e)})},this.redoResourceAdd=e=>{const{groups:t}=this.state,i=e.item;this.addUndoItem(i,e.actionName),t.splice(e.params.index,0,i),t.find(e=>e.id===i.parent).hasChildren=!0,this.setState({groups:t})},this.redoResourceRemove=e=>{this.removeResource(e.item)},this.redoResourceReorder=e=>{const{groups:t}=this.state,i=e.item,n=e.params.direction;this.addUndoItem(i,e.actionName,{direction:n}),this.handleReorderResource(null,t.find(e=>e.id===i.id),n,!1)},this.focusItems=e=>{if(!e||!Array.isArray(e)||e.length<=0)return;this.removeHighlight();let t=e[0].start.clone(),i=e[0].end.clone();e[0].highlight=!0,e.shift();for(const n of e)t.diff(n.start)>0&&(t=n.start.clone()),i.diff(n.end)<0&&(i=n.end.clone()),n.highlight=!0;t.subtract(1,"hour"),i.add(2,"hour"),this.timeline.current.updateScrollCanvas(t.valueOf(),i.valueOf())},this.renderPopup=e=>/*#__PURE__*/r.jsx(r.Fragment,{children:e.open&&(e.custom?e.custom({item:e.item,group:e.group}):/*#__PURE__*/r.jsx(ae,{item:e.item,group:e.group}))}),this.itemRenderer=({item:e,itemContext:t,getItemProps:i,getResizeProps:n})=>{const{left:o,right:s}=n();let a=e.bgColor,l=e.color;if(t.selected?(l=e.selectedColor,a=t.dragging?e.draggingBgColor:e.selectedBgColor):e.highlight?a=e.highlightBgColor:e.selectedGroup&&(a="#c3073f"),e.isHidden)return null;const d=this.state.groups.find(t=>t.id===e.group);/*#__PURE__*/return r.jsx(y.default,{content:/*#__PURE__*/u.default.cloneElement(this.props.tooltip,{item:e,group:d})||null,children:/*#__PURE__*/r.jsxs("div",{onMouseEnter:()=>this.handleShowIconsOnMouseEnter(null,e.id),onMouseLeave:()=>this.handleShowIconsOnMouseLeave(null,e.id),onKeyUp:t=>this.handleInputFieldOnKeyUp(t,null,e.id),...i({style:{background:a,color:l},onMouseDown:t=>{t.ctrlKey?e.selectedGroup=!0:(this.removeHighlight(),this.removeSelectedGroups(),e.selected=!0,e.selectedGroup=!0,this.highlightChildren(e),this.highlightParents(e),this.showItemInfo(this.state.items.find(t=>t.id===e.id))),this.setState({items:this.state.items})}}),id:"item-"+e.id,className:e.canMove?"movable-item":"static-item",children:[!t.selected||"both"!==e.canResize&&"left"!==e.canResize?"":t.useResizeHandle?/*#__PURE__*/r.jsx("div",{...o}):/*#__PURE__*/r.jsx("span",{style:{cursor:"ew-resize",width:3,zIndex:1e3,position:"absolute",top:0,left:-3,height:"100%"}}),/*#__PURE__*/r.jsx("div",{style:{height:t.dimensions.height,overflow:"hidden",paddingLeft:3,textOverflow:"ellipsis",whiteSpace:"nowrap",zIndex:"100",position:"sticky",left:0,maxWidth:"fit-content"},children:t.title}),e.dependency?/*#__PURE__*/r.jsx(p.default,{start:"item-"+e.dependency,end:"item-"+e.id,strokeWidth:2,headSize:6}):"",!t.selected||"both"!==e.canResize&&"right"!==e.canResize?"":t.useResizeHandle?/*#__PURE__*/r.jsx("div",{...s}):/*#__PURE__*/r.jsx("span",{style:{cursor:"ew-resize",width:3,zIndex:1e3,position:"absolute",top:0,right:-3,height:"100%"}})]})})},this.handleRemoveResource=(e,t)=>{e.stopPropagation(),!0===window.confirm(`Do you really want to remove resource ${t.title}?`)&&this.removeResource(t,!0)},this.removeResource=(e,t=!1)=>{const{groups:i}=this.state,n=i.indexOf(e);if(n>-1){const o=this.getAllChildren(e);this.addUndoItem(e,ce.RESOURCE_REMOVE,{index:n,children:o},t);const s=i.find(t=>t.id===e.parent);i.splice(n,1);for(const e of o){const t=i.indexOf(e);t>-1&&i.splice(t,1)}i.filter(e=>e.parent===s.id).length<=0&&(s.hasChildren=!1)}this.setState({groups:i})},this.getAllChildren=e=>{let t=this.state.groups.filter(t=>t.parent===e.id);for(const e of t.slice())t.splice(t.indexOf(e)+1,0,...this.getAllChildren(e));return t},this.handleShowIconsOnMouseEnter=(e,t)=>{let{groups:i}=this.state,{items:n}=this.state;if(e){const t=i.find(t=>t.id===e);t.showIcons=!0,this.setState({groups:i})}if(t){const e=n.find(e=>e.id===t);e.showIcons=!0,this.setState({items:n})}},this.handleShowIconsOnMouseLeave=(e,t)=>{let{groups:i}=this.state,{items:n}=this.state;if(e){const t=i.find(t=>t.id===e);t.showIcons=!1,this.setState({groups:i})}if(t){const e=n.find(e=>e.id===t);e.showIcons=!1,this.setState({items:n})}},this.handleEditMode=(e,t,i)=>{e.stopPropagation();let{groups:n}=this.state,{items:o}=this.state;if(t){const e=n.find(e=>e.id===t);e.isEditMode=!e.isEditMode,this.setState({groups:n})}if(i){const e=o.find(e=>e.id===i);e.isEditMode=!e.isEditMode,this.setState({items:o})}},this.handleInputFieldValue=(e,t,i)=>{let{groups:n}=this.state,{items:o}=this.state;if(t){const i=n.find(e=>e.id===t);this.addUndoItem(i,ce.RESOURCE_EDIT,{},!0),i.title=e.target.value}if(i){const t=o.find(e=>e.id===i);this.addUndoItem(t,ce.ITEM_EDIT,{},!0),t.title=e.target.value}},this.handleInputFieldOnKeyUp=(e,t,i)=>{"Enter"===e.key&&e.ctrlKey&&(this.handleEditMode(e,t,i),this.handleInputFieldValue(e,t,i)),"Escape"===e.key&&this.handleEditMode(e,t,i)},this.renderEditMode=()=>/*#__PURE__*/r.jsx("input",{autoFocus:!0,onClick:e=>e.stopPropagation(),placeholder:"Ctrl+Enter / Escape"}),this.getHighestGroupTreeIndex=e=>e.hasChildren?this.getHighestGroupTreeIndex(this.state.groups.filter(t=>t.parent===e.id).slice(-1)[0]):this.state.groups.indexOf(e),this.handleAddResource=e=>{this.setState({addResourceModal:e})},this.addResource=(e,t,i)=>{const{groups:n}=this.state,o={id:Math.max(...n.map(e=>e.id))+1,level:e.level,open:!1,parent:e.parent,show:!0,showIcons:!1,title:t};let s;i?(s=this.state.groups.indexOf(e),o.parent=e.id,o.level=e.level+1,e.open=!0,e.hasChildren=!0):s=this.getHighestGroupTreeIndex(e),n.splice(s+1,0,o),this.setState({groups:n,addResourceModal:!1}),this.addUndoItem(o,ce.RESOURCE_ADD)},this.renderAddResourceModal=e=>/*#__PURE__*/r.jsxs(le,{title:`Add resource - ${e.title}`,onClose:()=>{this.setState({addResourceModal:!1})},onSubmit:()=>{this.addResource(e,this.addResourceRefs.name.current.value,this.addResourceRefs.child.current.checked),this.addResourceRefs.name.current.value="",this.addResourceRefs.child.current.checked=!1},children:[/*#__PURE__*/r.jsxs("label",{children:["Insert resource name",/*#__PURE__*/r.jsx("input",{type:"text",placeholder:"Resource name",ref:this.addResourceRefs.name})]}),/*#__PURE__*/r.jsxs("label",{children:["Do you want to create this resource as a child?",/*#__PURE__*/r.jsx("input",{type:"checkbox",placeholder:"yes",ref:this.addResourceRefs.child})]})]}),this.handleReorderResource=(e,t,i,n=!0)=>{e&&e.stopPropagation();const o=this.getSiblings(t);let{groups:s}=this.state;if(o.length<=0)return;const r=o.indexOf(t);if(r<0)return;const a=s.indexOf(t);if(!(a<0)){if("up"===i){if(0===r)return;n&&this.addUndoItem(t,ce.RESOURCE_REORDER,{direction:i},!0);const e=s.indexOf(o[r-1]),l=s.slice(0,a),d=s.slice(a),c=l.splice(e);let u=d.indexOf(o[r+1]);if(u<0){const e=this.getAllChildren(t);u=e.length>0?d.indexOf(e[e.length-1])+1:1}const h=d.splice(0,u);s=[...l,...h,...c,...d]}else{if("down"!==i)return;{if(r===o.length-1)return;n&&this.addUndoItem(t,ce.RESOURCE_REORDER,{direction:i},!0);const e=s.indexOf(o[r+1]),l=s.slice(0,e),d=s.slice(e),c=l.splice(a);let u=d.indexOf(o[e+1]);if(u<0){const t=this.getAllChildren(s[e]);u=t.length>0?d.indexOf(t[t.length-1])+1:1}const h=d.splice(0,u);s=[...l,...h,...c,...d]}}t.showIcons=!1,this.setState({groups:s})}},this.getSiblings=e=>this.state.groups.filter(t=>t.parent===e.parent),this.getGroupsTree=e=>this.flatGroupToTree(this.state.groups,null,e),this.flatGroupToTree=(e,t=null,i=null)=>e.filter(e=>e.parent===t).map(t=>({label:t.title,value:t.id,isDefaultValue:t.id===i,children:this.flatGroupToTree(e,t.id,i)})),this.editItem=e=>{if(!e)return;const{editItemModal:t}=this.state;this.setState({editItemModal:{...t,currentGroupId:e.group,open:!0,item:e,title:`Edit item - ${e.title}`,mode:"edit",type:"item"}})},this.renderEditItemModal=()=>{const{editItemModal:e}=this.state;if(!e.open)return;const t=this.getGroupsTree(e.currentGroupId);/*#__PURE__*/return r.jsx(de,{title:e.title,item:e.item,milestone:e.milestone,currentGroupId:e.currentGroupId,groups:t,onSubmit:e.onSubmit,onClose:e.onClose,onDelete:e.onDelete,mode:e.mode,type:e.type})},this.handleOnItemDoubleClick=(e,t,i)=>{this.editItem(this.state.items.find(t=>t.id===e))},this.handleOnCanvasDoubleClick=(e,t,i)=>{const{items:n,milestones:o,editItemModal:s}=this.state,r=h.default(t),a=h.default(t).add(1,"hour");let l=Math.max(...n.map(e=>e.id));l===Number.NEGATIVE_INFINITY&&(l=1);const d={id:l+1,title:"",group:e,start:r,end:a};let c=Math.max(...o.map(e=>e.id));c===Number.NEGATIVE_INFINITY&&(c=0);const u={id:c+1,date:r};this.setMilestoneDefault(u),this.setItemDefaults(d),this.setState({editItemModal:{...s,currentGroupId:e,open:!0,item:d,milestone:u,title:"Add new item",mode:"add",type:"item"}})},this.handleEditItemModalDelete=(e,t,i)=>{if(e&&!e.removable||t&&!t.removable)return;const{items:n,milestones:o}=this.state;if("item"===i){const t=n.indexOf(e);t>-1&&(n.splice(t,1),this.addUndoItem(e,ce.ITEM_DELETE,{index:t},!0))}else if("milestone"===i){const e=o.indexOf(t);e>-1&&(o.splice(e,1),this.addUndoItem(t,ce.MILESTONE_DELETE,{index:e},!0))}const s=this.getEditItemModalDefaults();this.setState({items:n,milestones:o,editItemModal:s})},this.handleEditItemModalSubmit=(e,t,i,n,o)=>{const{items:s,milestones:r}=this.state;"item"===o?("add"===n?(s.push(e),this.addUndoItem(e,ce.ITEM_ADD,{},!0)):"edit"===n&&this.addUndoItem(e,ce.ITEM_EDIT,{},!0),i.date.from.month-=1,i.date.to.month-=1,e.title=i.title,e.start=h.default(i.date.from),e.end=h.default(i.date.to),e.group=i.groupId,e.color=i.color,e.bgColor=i.bgColor):"milestone"===o&&("add"===n?(r.push(t),this.addUndoItem(t,ce.MILESTONE_ADD,{},!0)):this.addUndoItem(t,ce.MILESTONE_EDIT,{},!0),i.milestoneDate.month-=1,t.label=i.label,t.date=h.default(i.milestoneDate),t.color=i.milestoneColor);const a=this.getEditItemModalDefaults();this.setState({items:s,milestones:r,editItemModal:a})},this.handleEditItemModalClose=()=>{const e=this.getEditItemModalDefaults();this.setState({editItemModal:e})},this.handleMilestoneDoubleClick=e=>{if(!e)return;const{editItemModal:t}=this.state;this.setState({editItemModal:{...t,milestone:e,open:!0,title:`Edit milestone - ${e.label}`,mode:"edit",type:"milestone"}})},this.groupOnEnter=e=>{if(this.state.sidebarResizing||!e)return;let t=this.state.sidebarWidth;e.scrollWidth>this.state.sidebarWidth&&(t=e.scrollWidth+10),this.setState({lastSidebarWidth:this.state.sidebarWidth,sidebarWidth:t})},this.groupOnLeave=()=>{this.state.sidebarResizing||this.setState({sidebarWidth:this.state.lastSidebarWidth})},this.showOverview=()=>{const{defaultTimeStart:e,defaultTimeEnd:t}=this.state;this.timeline.current.updateScrollCanvas(e.valueOf(),t.valueOf())},this.showCurrentWeek=()=>{const e=h.default();this.timeline.current.updateScrollCanvas(e.clone().subtract(84,"hour").valueOf(),e.clone().add(84,"hour").valueOf())},this.renderGroup=e=>{const t=this.getSiblings(e);let o=!1,s=!0,a=!0;return t.length>1&&(o=!0,t[0]===e&&(a=!1),t[t.length-1]===e&&(s=!1)),/*#__PURE__*/r.jsxs("div",{className:"resource-group",children:[/*#__PURE__*/r.jsxs("div",{className:"resource",onClick:()=>this.toggleGroup(e.id),style:{cursor:"pointer",paddingLeft:20*e.level,color:"#eae9e9"},children:[e.hasChildren?e.isEditMode?e.open?"[-] ":"[+] ":e.open?`[-] ${e.title} `:`[+] ${e.title} `:e.isEditMode?"":e.title,e.isEditMode&&this.renderEditMode(e.id),e.showIcons&&/*#__PURE__*/r.jsxs("div",{className:"action-icons",children:[/*#__PURE__*/r.jsx("span",{onClick:t=>this.handleEditMode(t,e.id),className:"edit-icon",children:/*#__PURE__*/r.jsx(i.HiOutlinePencil,{})}),/*#__PURE__*/r.jsx("span",{className:"remove-icon action-icon",onClick:t=>this.handleRemoveResource(t,e),children:/*#__PURE__*/r.jsx(n.FaPlus,{})}),/*#__PURE__*/r.jsxs("div",{className:"reorder-icons",children:[/*#__PURE__*/r.jsx("span",{onClick:t=>this.handleReorderResource(t,e,"up"),className:`order-up-icon order-icon ${o&&a?"":"disabled"} action-icon`,children:/*#__PURE__*/r.jsx(n.FaArrowUp,{})}),/*#__PURE__*/r.jsx("span",{onClick:t=>this.handleReorderResource(t,e,"down"),className:`order-down-icon order-icon ${o&&s?"":"disabled"} action-icon`,children:/*#__PURE__*/r.jsx(n.FaArrowDown,{})})]})]})]}),e.editable&&(e.showIcons||!0)&&/*#__PURE__*/r.jsx(n.FaPlus,{className:"add-resource",onClick:()=>this.handleAddResource(e)})]})},this.renderMilestones=()=>{const{milestones:e}=this.state;return e.map(e=>/*#__PURE__*/r.jsx(o.CustomMarker,{date:e.date.valueOf(),children:({styles:t})=>{const i={...t,backgroundColor:e.color?e.color:"#000",width:"3px",pointerEvents:"auto",zIndex:1e3};/*#__PURE__*/return r.jsx("div",{style:i,className:"milestone",onDoubleClick:()=>this.handleMilestoneDoubleClick(e),children:/*#__PURE__*/r.jsxs("span",{className:"milestone-label",children:[e.label?e.label:"",/*#__PURE__*/r.jsx("br",{}),/*#__PURE__*/r.jsx("span",{className:"milestone-date",children:e.date.format("LLL")})]})})}},"marker-"+e.id))},this.actions=[],this.redoActions=[];let t=e.items||[],s=e.groups||[];Array.isArray(t)||(t=[]),Array.isArray(s)||(s=[]);for(const e of t)this.setItemDefaults(e);s=this.getSortedGroupsByParent(s);let a=h.default().subtract(24,"hour"),l=h.default().add(24,"hour");t.length>0&&(a=h.default(Math.min(...t.filter(e=>null!==e.start).map(e=>h.default(e.start)))).subtract(12,"hour"),l=h.default(Math.max(...t.filter(e=>null!==e.end).map(e=>h.default(e.end)))).add(12,"hour"));const d={open:!1,item:null,custom:null!=e.popup&&e.popup};let c=[];e.milestones&&(c=e.milestones),this.timeline=/*#__PURE__*/u.default.createRef(),this.addResourceRefs={name:/*#__PURE__*/u.default.createRef(),child:/*#__PURE__*/u.default.createRef()};const m=this.getEditItemModalDefaults();this.state={groups:s,items:t,defaultTimeStart:a,defaultTimeEnd:l,sidebarWidth:300,sidebarResizing:!1,lastSidebarWidth:300,popup:d,milestones:c,showIcons:!1,addResourceModal:!1,editItemModal:m}}getSortedGroupsByParent(e){return e.sort((e,t)=>e.level-t.level).reduce((e,t)=>{let i=e.find(e=>e.id===t.parent),n=e.indexOf(i);const o=e.filter(e=>e.parent===t.parent).length;return n=-1!==n?n+o+1:e.length,e.splice(n,0,t),e},[])}onTimeChange(e,t,i,n){i(e,t)}componentDidUpdate(e){e.groups!==this.props.groups&&this.setState({groups:this.getSortedGroupsByParent(this.props.groups)}),e.items!==this.props.items&&this.setState({items:this.props.items})}render(){const{groups:e,items:t,defaultTimeStart:i,defaultTimeEnd:n,sidebarWidth:s}=this.state,a=e.filter(e=>e.show).map(e=>{const t=this;return Object.assign({},e,{title:/*#__PURE__*/r.jsx("div",{onMouseEnter:function(i){try{const{currentTarget:n}=i;return Promise.resolve(t.handleShowIconsOnMouseEnter(e.id)).then(function(){t.groupOnEnter(n)})}catch(i){return Promise.reject(i)}},onMouseLeave:()=>{this.handleShowIconsOnMouseLeave(e.id),this.groupOnLeave()},onKeyUp:t=>this.handleInputFieldOnKeyUp(t,e.id),children:this.props.groupRenderer?this.props.groupRenderer(e):this.renderGroup(e)})})});/*#__PURE__*/return r.jsxs(r.Fragment,{children:[/*#__PURE__*/r.jsxs("div",{className:"timeline-container",children:[/*#__PURE__*/r.jsxs(m.default,{className:"timeline",ref:this.timeline,groups:a,items:t,keys:ue,onZoom:this.props.onZoom,fullUpdate:!0,itemTouchSendsClick:this.props.itemTouchSendsClick??!1,stackItems:!0,itemHeightRatio:this.props.itemHeightRatio??.75,canMove:!0,canResize:"both",sidebarWidth:this.props.sidebarWidth??s,defaultTimeStart:this.props.defaultTimeStart??i,defaultTimeEnd:this.props.defaultTimeStart??n,onTimeChange:this.props.onTimeChange??this.onTimeChange,itemRenderer:this.props.itemRenderer??this.itemRenderer,onItemMove:this.props.onItemMove??this.handleItemMove,onItemResize:this.props.onItemResize??this.handleItemResize,onItemDeselect:this.props.onItemDeselect??this.itemDeselected,onItemDoubleClick:this.props.onItemDoubleClick??this.handleOnItemDoubleClick,onCanvasDoubleClick:this.props.onCanvasDoubleClick??this.handleOnCanvasDoubleClick,onItemDrag:this.props.onItemDrag??this.handleItemDrag,horizontalLineClassNamesForGroup:this.props.horizontalLineClassNamesForGroup,handleSidebarResize:this.props.handleSidebarResize??{down:this.onSidebarDown,move:this.onSidebarMove,up:this.onSidebarUp,resizing:this.state.sidebarResizing},children:[/*#__PURE__*/r.jsx(o.TimelineMarkers,{children:/*#__PURE__*/r.jsx(o.TodayMarker,{interval:1e3,children:({styles:e})=>{const t={...e,...this.props.todayMarkerStyles};/*#__PURE__*/return r.jsx("div",{style:t})}})}),this.renderMilestones()]}),/*#__PURE__*/r.jsxs("div",{className:"right-side-items-container",children:[/*#__PURE__*/r.jsx("div",{className:"action-buttons-container",children:/*#__PURE__*/r.jsxs("div",{className:"action-buttons",children:[/*#__PURE__*/r.jsx("button",{className:"action-button "+(this.actions.length<=0?"disabled":""),onClick:this.undo,children:"Undo"}),/*#__PURE__*/r.jsx("button",{className:"action-button "+(this.redoActions.length<=0?"disabled":""),onClick:this.redo,children:"Redo"}),/*#__PURE__*/r.jsx("button",{className:"action-button",onClick:this.showOverview,children:"Overview"}),/*#__PURE__*/r.jsx("button",{className:"action-button",onClick:this.showCurrentWeek,children:"Current week"}),this.props.additionalComponents.additionalButtons]})}),this.props.additionalComponents.rightSideContainer]}),this.props.additionalComponents.mainContainer]}),this.state.addResourceModal&&this.renderAddResourceModal(this.state.addResourceModal),this.renderEditItemModal()]})}}he.propTypes={items:re.arrayOf(re.shape({id:re.number.isRequired,group:re.number.isRequired,title:re.string,start:re.instanceOf(h.default).isRequired,end:re.instanceOf(h.default).isRequired,parent:re.number,className:re.string,bgColor:re.string,color:re.string,selectedBgColor:re.string,selectedColor:re.string,draggingBgColor:re.string,highlightBgColor:re.string,highlight:re.bool,canMove:re.bool,canResize:re.oneOf(["both","left","right",!1]),minimumDuration:re.oneOfType([re.number,re.oneOf([!1])]),maximumDuration:re.oneOfType([re.number,re.oneOf([!1])]),workTime:re.number,plannedWorkTime:re.number})).isRequired,onItemDoubleClick:re.func,groups:re.arrayOf(re.shape({id:re.number.isRequired,title:re.string.isRequired,hasChildren:re.bool,parent:re.number,open:re.bool.isRequired,show:re.bool.isRequired,level:re.number.isRequired})).isRequired,popup:re.elementType,milestones:re.arrayOf(re.shape({date:re.instanceOf(h.default).isRequired,label:re.string,color:re.string,removable:re.bool})),sidebarWidth:re.number,defaultTimeStart:re.instanceOf(h.default),defaultTimeEnd:re.instanceOf(h.default),tooltip:re.elementType.isRequired,additionalComponents:re.object,groupRenderer:re.func,itemRenderer:re.func,itemHeightRatio:re.number,itemTouchSendsClick:re.bool,todayMarkerStyles:re.object,onTimeChange:re.func,onItemMove:re.func,onItemResize:re.func,onItemDeselect:re.func,onCanvasDoubleClick:re.func,onItemDrag:re.func,handleSidebarResize:re.object,horizontalLineClassNamesForGroup:re.arrayOf(re.string),onZoom:re.func},he.defaultProps={items:[{parent:null,className:"item",bgColor:"#2196F3",color:"#fff",selectedBgColor:"#FFC107",selectedColor:"#000",draggingBgColor:"#f00",highlightBgColor:"#FFA500",highlight:!1,canMove:!0,canResize:"both",minimumDuration:!1,maximumDuration:!1,removable:!0}],groups:[],popup:ae,tooltip:/*#__PURE__*/r.jsx(ae,{})},exports.PlanningTool=he;
//# sourceMappingURL=react-maintenance-planner.js.map
